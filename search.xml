<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Linux</title>
      <link href="/posts/Linux/"/>
      <url>/posts/Linux/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\css\APlayer.min.css"><script src="\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\js\Meting.min.js"></script><h1 id="Linux的远程连接和文件传输"><a href="#Linux的远程连接和文件传输" class="headerlink" title="Linux的远程连接和文件传输"></a>Linux的远程连接和文件传输</h1><ul><li>Windows使用下面两种工具对linux的远程连接和文件传输。</li><li>Xshell:终端模拟器</li><li>Xftp:为远程文件传输软件<br><a href="https://www.netsarang.com/zh/all-downloads/" target="_blank" rel="noopener">点击进入下载</a></li></ul><h1 id="Linux的目录结构"><a href="#Linux的目录结构" class="headerlink" title="Linux的目录结构"></a>Linux的目录结构</h1><ul><li><p><strong>bin</strong>：存放常用命令的目录，如vi，su</p></li><li><p><strong>boot</strong>：存放引导系统启动的相关文件</p></li><li><p><strong>dev</strong>： 用于存放设备文件</p></li><li><p><strong>etc</strong>：存放系统配置相关文件</p></li><li><p><strong>home</strong>：存放普通用户的相关文件</p></li><li><p><strong>lib</strong>： 存放跟文件系统中的程序运行所需要的共享库及内核模块</p></li><li><p><strong>mnt</strong>：默认挂载光驱和软驱的目录，系统管理员安装临时文件系统的安装点</p></li><li><p><strong>opt</strong>：这是给主机额外安装软件所摆放，如安装oracle数据库就可放到该目录下默认为空。</p></li><li><p><strong>proc</strong>：这个目录是一个虚拟的目录，它是系统内存的映射，访问这个目录来获取系统信息</p></li><li><p><strong>root</strong>：存放root用户的相关文件</p></li><li><p><strong>sbin</strong>：存放二进制可执行文件，要具有一定权限才可以使用命令</p></li><li><p><strong>srv</strong>：service缩写。该目录存放一些服务启动之后需要提取的数据</p></li><li><p><strong>sys</strong>：这是linux2.6内核的一个很大的变化，该目录下安装了2.6内核中新出现的一个文件系统</p></li><li><p><strong>tmp</strong>：这个目录是用来存放一些临时文件的</p></li><li><p><strong>var</strong>：存放经常变化的文件，如网络连接的sock文件 、日志</p></li><li><p><strong>usr</strong>：安装一个软件的默认目录，相当于windows下的program files</p></li><li><p><strong>del</strong>：类似于windows的设备管理器，把所有的硬件用文件的形式存储</p></li><li><p><strong>meda</strong>：系统提供该目录是为了让用户临时挂载别的文件系统的，我们可以将外部的存储挂载在/mnt/上，然后进入该目录就可以查看里面的内容了。</p></li><li><p><strong>selinux</strong>：selinux是一种安全子系统，它能控制程序只能访问特定文件。</p></li></ul><h1 id="Linux常用命令"><a href="#Linux常用命令" class="headerlink" title="Linux常用命令"></a>Linux常用命令</h1><p><img src="/blog-img/Linux/Linux%E5%B8%B8%E8%A7%81%E5%BF%AB%E6%8D%B7%E9%94%AE%E5%92%8C%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4.jpg" alt="Linux常见快捷键和基本命令"> </p><h2 id="命令基本格式"><a href="#命令基本格式" class="headerlink" title="命令基本格式"></a>命令基本格式</h2><ul><li><code>cmd [options] [arguments]</code> 用空格分隔开</li><li>Linux是区分大小写的<br>一般来说，后面跟的选项如果单字符选项前使用一个减号-。单词选项前使用两个减号–</li></ul><h2 id="磁盘管理"><a href="#磁盘管理" class="headerlink" title="磁盘管理"></a>磁盘管理</h2><ul><li>切换目录：<code>cd 目录名</code></li><li>列出当前目录下目录及文件：<code>ll,ls</code></li><li>显示当前所在目录位置：<code>pwd</code></li></ul><h2 id="文件管理"><a href="#文件管理" class="headerlink" title="文件管理"></a>文件管理</h2><ul><li>创建目录：<code>mkdir 目录名</code></li><li>删除文件或目录：<code>rm , rm -rf</code>  (r:递归 f:强制删除)</li><li>复制文件：<code>cp , cp -rf</code></li><li>查看文件全部内容：<code>cat 文件路径</code></li><li>分页查看文件内容： <code>more 文件路径</code></li><li>查看文件开头的n行数据：<code>head -n数字</code></li><li>显示文件尾部的n行数据：<code>tail -n数字</code></li><li>文件内搜索：<code>grep 搜索的内容 文件名1，文件名2</code></li></ul><h2 id="系统命令"><a href="#系统命令" class="headerlink" title="系统命令"></a>系统命令</h2><ul><li>显示系统日期和时间：<code>date</code></li><li>切换用户: <code>su 用户</code></li><li>清除屏幕：<code>clear</code></li><li>重启系统：<code>reboot</code></li><li>关机：<code>shutdown</code></li><li>查看系统进程：<code>ps -ef</code></li><li>kill进程：<code>kill pid</code></li></ul><h2 id="压缩-解压"><a href="#压缩-解压" class="headerlink" title="压缩/解压"></a>压缩/解压</h2><ul><li><p>tar压缩：<code>tar -zvcf 压缩文件名 压缩的文件列表</code><br>tar -zvcf txtfile.tar.gz a.txt</p></li><li><p>查看压缩文件：<code>tar -tf</code></p></li><li><p>tar解压：<code>tar -zxvf 压缩文件名</code> </p></li><li><p>tar解压到：<code>tar -zxvf 压缩文件名 -C 目录</code></p></li></ul><h2 id="网络通讯"><a href="#网络通讯" class="headerlink" title="网络通讯"></a>网络通讯</h2><ul><li><p>查看ip信息：<code>ifconfig</code></p></li><li><p>测试网络连接：<code>ping url</code></p><h2 id="网络访问"><a href="#网络访问" class="headerlink" title="网络访问"></a>网络访问</h2></li><li><p>使用url访问网络的文件传输工具: <code>curl www.baidu.com</code></p><ol><li>测试网络访问</li><li>模拟用户访问</li></ol></li><li><p>下载：<code>wget 下载的资源的地址</code></p></li></ul><h2 id="权限管理"><a href="#权限管理" class="headerlink" title="权限管理"></a>权限管理</h2><ul><li><p>执行ll显示<br><img src="/blog-img/Linux/%E6%9D%83%E9%99%90.jpg" alt=""></p></li><li><p>常见权限设置<br>  -rwx-xr-x 等于761<br>  -U(所属用户)-G（所属用户组）-O（其他）<br>  r–read 读权限 4<br>  w–write 写权限 2<br>  x–execute 执行权限 1<br>常见 644，755，777</p></li><li><p>修改文件权限：<code>chmod UGO权限  文件/目录</code><br>chmod 646 a.txt</p></li><li><p>修改文件拥有着：<code>chown 新拥有者 文件</code></p></li></ul><h2 id="管道和重定向"><a href="#管道和重定向" class="headerlink" title="管道和重定向"></a>管道和重定向</h2><ul><li>重定向输出覆盖：<code>&gt;</code><br><code>echp &quot;hello&quot; &gt; a.txt</code></li><li>重定向追加：<code>&gt;&gt;</code></li><li>管道：<code>|</code><br><code>cat a.txt | grep hello</code></li></ul><h2 id="vi和vim编辑器"><a href="#vi和vim编辑器" class="headerlink" title="vi和vim编辑器"></a>vi和vim编辑器</h2><h3 id="启动vi编辑器：vi-文件名"><a href="#启动vi编辑器：vi-文件名" class="headerlink" title="启动vi编辑器：vi 文件名"></a>启动vi编辑器：vi 文件名</h3><ul><li>命令模式：按esc进入</li><li>编辑模式；a,i,o 进入，<code>:wq</code>保存退出 <code>:q!</code>不保存退出</li></ul><h3 id="编辑文件命令"><a href="#编辑文件命令" class="headerlink" title="编辑文件命令"></a>编辑文件命令</h3><ul><li>dd:删除光标所在行</li><li>yy:复制光标所在行到缓冲区</li><li>p:粘贴缓冲区中的内容</li><li>gg:光标回到文件第一行</li><li>GG:光标回到文件最后一行</li><li><code>^</code>:光标当前行的行首</li><li><code>$</code>:光标当前行的行尾</li><li><code>/</code>:/+搜索的字符，按n下一个搜到的字符</li></ul><h2 id="安装软件"><a href="#安装软件" class="headerlink" title="安装软件"></a>安装软件</h2><ul><li><p>查找软件包命令：<code>yum search 安装包名称中的部分关键字</code><br><code>yum search java</code></p></li><li><p>安装指定的软件命令：<code>yum instal 安装包名称</code></p></li><li><p>删除软件包命令：<code>yum remove 安装包名称</code></p></li><li><p>列出所有已安装的软件包命令：<code>yum list installed</code></p></li><li><p>清除已安装软件包的下载文件命令：<code>yum clean all</code> yum命令下载的安装包都在/var/cache/yum 下</p></li></ul><h1 id="开发相关"><a href="#开发相关" class="headerlink" title="开发相关"></a>开发相关</h1><h1 id="使用VMware创建Linux系统的虚拟机"><a href="#使用VMware创建Linux系统的虚拟机" class="headerlink" title="使用VMware创建Linux系统的虚拟机"></a>使用VMware创建Linux系统的虚拟机</h1><blockquote><p>虚拟机（Virtual Machine）指通过软件模拟的具有完整硬件系统功能的、运行在一个完全隔离环境中的完整计算机系统。<br>在实体计算机中能够完成的工作在虚拟机中都能够实现。在计算机中创建虚拟机时，需要将实体机的部分硬盘和内存容量<br>作为虚拟机的硬盘和内存容量。每个虚拟机都有独立的CMOS、硬盘和操作系统，可以像使用实体机一样对虚拟机进行操作。</p></blockquote><ul><li><p>下载链接:<a href="https://my.vmware.com/cn/web/vmware/info/slug/desktop_end_user_computing/vmware_workstation_pro/15_0" target="_blank" rel="noopener">VMware-Workstation</a></p></li><li><p>下载好后检查虚拟网卡 <img src="/blog-img/Linux/%E6%A3%80%E6%9F%A5%E8%99%9A%E6%8B%9F%E7%BD%91%E5%8D%A1.jpg" alt="检查虚拟网卡"> 存在就继续</p></li></ul><h2 id="安装Centos"><a href="#安装Centos" class="headerlink" title="安装Centos"></a>安装Centos</h2><ol><li>下载链接:<a href="https://www.centos.org/download/" target="_blank" rel="noopener">centos</a> 下载dvd标准安装版</li><li>打开VMware创建虚拟机，选择下载的centos路径 <img src="/blog-img/Linux/1.jpg" alt=""> </li></ol><p>*没说明的默认就好<br>3. 选择虚拟机的安装空间（大于20G） <img src="/blog-img/Linux/2.jpg" alt=""><br>4. 设置虚拟机的配置 <img src="/blog-img/Linux/3.jpg" alt=""><br>5. 启动虚拟机安装Linux操作系统<br>   出现pane is dead 在设置里把CD/DVD(IDE)autoinst.iso移除就ok<br>   然后进入点安装<img src="/blog-img/Linux/4.jpg" alt=""><br>6. 设置系统语言 选择英文，中文有时候会出现异常    <img src="/blog-img/Linux/5.jpg" alt=""><br>7. 设置支持的语言和时间，还有网络 <img src="/blog-img/Linux/6.jpg" alt=""><br>8. 设置密码，然后等待安装  <img src="/blog-img/Linux/7.jpg" alt=""><br>9. 重启系统，勾选协议，然后设置一个除root以外的用户，然后登录就可以了。</p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> OS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Github连接问题</title>
      <link href="/posts/githublianjie/"/>
      <url>/posts/githublianjie/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\css\APlayer.min.css"><script src="\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\js\Meting.min.js"></script><h1 id="今天上传博客时至github失败，ping-GitHub-com超时"><a href="#今天上传博客时至github失败，ping-GitHub-com超时" class="headerlink" title="今天上传博客时至github失败，ping GitHub.com超时"></a>今天上传博客时至github失败，ping GitHub.com超时</h1><pre><code>C:\Users\ajun&gt;ping github.com正在 Ping github.com [192.30.255.112] 具有 32 字节的数据:请求超时。请求超时。请求超时。请求超时。192.30.255.112 的 Ping 统计信息:    数据包: 已发送 = 4，已接收 = 0，丢失 = 4 (100% 丢失)，</code></pre><p>一顿百度后找到解决办法。<br>打开<code>C:\Windows\System32\drivers\etc\hosts</code> ，复制下面内容保存。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">192.30.255.112  github.com git </span><br><span class="line">185.31.16.184 github.global.ssl.fastly.net</span><br></pre></td></tr></table></figure><p>然后就可以了</p>]]></content>
      
      
      <categories>
          
          <category> 问题集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 问题集 </tag>
            
            <tag> GitHub </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpringMVC</title>
      <link href="/posts/SpringMVC/"/>
      <url>/posts/SpringMVC/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\css\APlayer.min.css"><script src="\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\js\Meting.min.js"></script><h1 id="第1章-SpringMVC-概述"><a href="#第1章-SpringMVC-概述" class="headerlink" title="第1章 SpringMVC 概述"></a><center>第1章 SpringMVC 概述</center></h1><h2 id="SpringMVC-简介"><a href="#SpringMVC-简介" class="headerlink" title="SpringMVC 简介"></a>SpringMVC 简介</h2><ul><li>SpringMVC 也叫 Spring web mvc。是 Spring 框架的一部分，是在 Spring3.0 后发布的。</li></ul><h2 id="SpringMVC-优点"><a href="#SpringMVC-优点" class="headerlink" title="SpringMVC 优点"></a>SpringMVC 优点</h2><ol><li><p><strong>基于 MVC 架构，功能分工明确，解耦合</strong>  </p></li><li><p><strong>容易理解，上手快；使用简单。</strong>   </p></li><li><p><strong>作为Spring框架一部分，能够使用Spring的IoC和Aop。方便整合Strtus,MyBatis,Hiberate,JPA 等其他框架。</strong></p></li><li><p><strong>SpringMVC 强化注解的使用，在控制器，Service，Dao 都可以使用注解。方便灵活。</strong><br>使用@Controller 创建处理器对象,@Service 创建业务对象，@Autowired 或者@Resource，在控制器类中注入 Service, Service 类中注入 Dao。</p></li></ol><h2 id="第一个SpringMVC程序"><a href="#第一个SpringMVC程序" class="headerlink" title="第一个SpringMVC程序"></a>第一个SpringMVC程序</h2><h3 id="新建maven-web项目"><a href="#新建maven-web项目" class="headerlink" title="新建maven web项目"></a>新建maven web项目</h3><p><img src="/blog-img/SpringMVC/maven-web.jpg" alt=""></p><h3 id="pom-xml加入依赖"><a href="#pom-xml加入依赖" class="headerlink" title="pom.xml加入依赖"></a>pom.xml加入依赖</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>4.11<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.5.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="注册中央调度器-DispatcherServlet"><a href="#注册中央调度器-DispatcherServlet" class="headerlink" title="注册中央调度器(DispatcherServlet)"></a>注册中央调度器(DispatcherServlet)</h3><ul><li>springmvc的核心对象DispatcherServlet(本质是一个servlet)需要在tomcat服务器启动后，创建DispatcherServlet对象<br>的实例。初始化会执行init()方法，读取springMVC配置文件得到springMVC容器和里面的对象。<ol><li>创建容器，读取配置文件<br><code>WebApplicationContext ctx = new ClassPathXmlApplicationContext(&quot;springmvc.xml&quot;);</code></li><li>把容器对象放入到ServletContext中<br><code>getServletContext().setAttribute(key, ctx);</code></li></ol></li><li>springmvc创建容器对象时，读取的配置文件默认是/WEB-INF/<servlet-name>-servlet.xml，可以在xml中指定自定义文件的位置  <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">web-app</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>myweb<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--自定义springmvc读取的配置文件的位置--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--springmvc的配置文件的位置的属性--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--指定自定义文件的位置--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:springmvc.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- load-on-startup:它的值是整数</span></span><br><span class="line"><span class="comment">当值大于等于 0 时，表示容器在启动时就加载并初始化这个 servlet，数值越小,Servlet的优先级就越高，其被创建的也就越早；</span></span><br><span class="line"><span class="comment">当值小于 0 或者没有指定时，则表示该 Servlet 在真正被使用时才会去创建。</span></span><br><span class="line"><span class="comment">当值相同时，容器会自己选择创建顺序。--&gt;</span></span><br></pre></td></tr></table></figure></li><li>使用框架的时候， url-pattern可以使用两种值<br>1)使用扩展名方式， 语法 <code>*</code>.xxxx , xxxx是自定义的扩展名。 常用的方式 <code>*</code>.do, <code>*</code>.action, <code>*</code>.mvc等等<br> 不能使用 <code>*</code>.jsp<br>2)使用斜杠 “/“  <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>myweb<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>*.do<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="创建springMVC配置文件"><a href="#创建springMVC配置文件" class="headerlink" title="创建springMVC配置文件"></a>创建springMVC配置文件</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--声明组件扫描器--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"cn.JInterest.controller"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--声明 springmvc框架中的视图解析器， 帮助开发人员设置视图文件的路径--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span>  <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--前缀：视图文件的路径--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/view/"</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--后缀：视图文件的扩展名--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="创建处理器"><a href="#创建处理器" class="headerlink" title="创建处理器"></a>创建处理器</h3><p><strong>@Controller：</strong></p><ul><li><strong>作用</strong>：创建控制器（处理器）对象，对象放在springmvc容器中。</li><li><strong>位置</strong>：在类的上面<br>能处理请求的都是控制器（处理器），叫做后端控制器（back controller）</li></ul><p><strong>@RequestMapping：请求映射</strong></p><ul><li><strong>作用</strong>：把一个请求地址和一个方法绑定在一起。一个请求指定一个方法处理。</li><li><strong>属性</strong>：<br>1）value 是一个String，表示请求的uri地址的（some.do）。value值必须是唯一，在使用时，推荐地址以“/”开始<br>2）method 表示请求的方式。 它的值RequestMethod类枚举值。例如表示get请求方式， RequestMethod.GET。不写表示可以接受get和post</li><li><strong>位置</strong>：<br>1）在方法的上面，常用的。<br>2）在类的上面 ,value=所有请求地址的公共部分，叫做模块名称</li><li><strong>说明</strong>：<br>使用RequestMapping修饰的方法叫做处理器方法或者控制器方法，是可以处理请求的，类似Servlet中的doGet, doPost</li><li><strong>返回值</strong>：<br><code>ModelAndView</code> 表示本次请求的处理结果<br><code>Model</code>: 数据，请求处理完成后，要显示给用户的数据 <code>View</code>: 视图， 比如jsp等等。</li></ul><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">   处理用户提交的请求，springmvc中是使用方法来处理的。</span></span><br><span class="line"><span class="comment">   方法是自定义的， 可以有多种返回值， 多种参数，方法名称自定义</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = &#123;<span class="string">"/some.do"</span>,<span class="string">"/first.do"</span>&#125;)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">doSome</span><span class="params">()</span></span>&#123;  </span><br><span class="line">        <span class="comment">//service调用...</span></span><br><span class="line">        <span class="comment">//处理some.do请求。</span></span><br><span class="line"></span><br><span class="line">        ModelAndView mv  = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">        <span class="comment">//添加数据， 框架在请求的最后把数据放入到request作用域。</span></span><br><span class="line">        <span class="comment">//request.setAttribute("msg","欢迎使用springmvc做web开发");</span></span><br><span class="line">        mv.addObject(<span class="string">"msg"</span>,<span class="string">"欢迎使用springmvc做web开发"</span>);</span><br><span class="line">        mv.addObject(<span class="string">"fun"</span>,<span class="string">"执行的是doSome方法"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//指定视图, 指定视图的完整路径</span></span><br><span class="line">        <span class="comment">//框架默认对视图执行的forward操作， request.getRequestDispather("/show.jsp).forward(...)</span></span><br><span class="line">        <span class="comment">//mv.setViewName("/show.jsp");</span></span><br><span class="line"><span class="comment">//放入WEB-INF/下受保护</span></span><br><span class="line">        <span class="comment">//mv.setViewName("/WEB-INF/view/show.jsp");</span></span><br><span class="line"><span class="comment">//当配置了视图解析器后，可以使用逻辑名称（文件名），指定视图</span></span><br><span class="line">        <span class="comment">//框架会使用视图解析器的前缀 + 逻辑名称 + 后缀 组成完成路径， 这里就是字符连接操作</span></span><br><span class="line">        <span class="comment">///WEB-INF/view/ + show + .jsp</span></span><br><span class="line">        mv.setViewName(<span class="string">"show"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//返回mv</span></span><br><span class="line">        <span class="keyword">return</span> mv;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = &#123;<span class="string">"/other.do"</span>,<span class="string">"/second.do"</span>&#125;)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">doOther</span><span class="params">()</span></span>&#123;</span><br><span class="line">        ModelAndView mv  = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">        mv.addObject(<span class="string">"msg"</span>,<span class="string">"====欢迎使用springmvc做web开发===="</span>);</span><br><span class="line">        mv.addObject(<span class="string">"fun"</span>,<span class="string">"执行的是doOther方法"</span>);</span><br><span class="line">        mv.setViewName(<span class="string">"other"</span>);</span><br><span class="line">        <span class="keyword">return</span> mv;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="定义请求页面和目标页面"><a href="#定义请求页面和目标页面" class="headerlink" title="定义请求页面和目标页面"></a>定义请求页面和目标页面</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;%@ page contentType&#x3D;&quot;text&#x2F;html;charset&#x3D;UTF-8&quot; language&#x3D;&quot;java&quot; %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;&#x2F;title&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;p&gt;第一个springmvc项目&lt;&#x2F;p&gt;</span><br><span class="line">&lt;p&gt;&lt;a href&#x3D;&quot;some.do&quot;&gt;发起some.do的请求&lt;&#x2F;a&gt; &lt;&#x2F;p&gt;</span><br><span class="line">&lt;p&gt;&lt;a href&#x3D;&quot;other.do&quot;&gt;发起other.do的请求&lt;&#x2F;a&gt; &lt;&#x2F;p&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;%@ page contentType&#x3D;&quot;text&#x2F;html;charset&#x3D;UTF-8&quot; language&#x3D;&quot;java&quot; %&gt;</span><br><span class="line">&lt;%@ page  isELIgnored&#x3D;&quot;false&quot;%&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;&#x2F;title&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h3&gt;&#x2F;WEB-INF&#x2F;view&#x2F;show.jsp从request作用域获取数据&lt;&#x2F;h3&gt;&lt;br&#x2F;&gt;</span><br><span class="line">    &lt;h3&gt;msg数据: $&#123;msg&#125; &lt;&#x2F;h3&gt;&lt;br&#x2F;&gt;</span><br><span class="line">    &lt;h3&gt;fun数据: $&#123;fun&#125; &lt;&#x2F;h3&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure><h2 id="SpringMVC执行流程（理解）"><a href="#SpringMVC执行流程（理解）" class="headerlink" title="SpringMVC执行流程（理解）"></a>SpringMVC执行流程（理解）</h2><h3 id="流程图"><a href="#流程图" class="headerlink" title="流程图"></a>流程图</h3><p><img src="/blog-img/SpringMVC/SpringMVC%E6%B5%81%E7%A8%8B%E5%9B%BE.jpg" alt=""></p><h3 id="执行流程简单分析"><a href="#执行流程简单分析" class="headerlink" title="执行流程简单分析"></a>执行流程简单分析</h3><p>（1）浏览器提交请求到中央调度器<br>（2）中央调度器直接将请求转给处理器映射器。<br>（3）处理器映射器会根据请求，找到处理该请求的处理器，并将其封装为处理器执行链后返回给中央调度器。<br>（4）中央调度器根据处理器执行链中的处理器，找到能够执行该处理器的处理器适配器。<br>（5）处理器适配器调用执行处理器。<br>（6）处理器将处理结果及要跳转的视图封装到一个对象 ModelAndView 中，并将其返回给处理器适配器。<br>（7）处理器适配器直接将结果返回给中央调度器。<br>（8）中央调度器调用视图解析器，将 ModelAndView 中的视图名称封装为视图对象。<br>（9）视图解析器将封装了的视图对象返回给中央调度器<br>（10）中央调度器调用视图对象，让其自己进行渲染，即进行数据填充，形成响应对象。<br>（11）中央调度器响应浏览器</p><h1 id="第2章-SpringMVC的核心技术"><a href="#第2章-SpringMVC的核心技术" class="headerlink" title="第2章 SpringMVC的核心技术"></a><center>第2章 SpringMVC的核心技术</center></h1><h2 id="请求重定向和转发"><a href="#请求重定向和转发" class="headerlink" title="请求重定向和转发"></a>请求重定向和转发</h2><ul><li>请求处理完毕的两种跳转方式。<br><img src="/blog-img/SpringMVC/%E9%87%8D%E5%AE%9A%E5%90%91%E5%92%8C%E8%BD%AC%E5%8F%91.jpg" alt="求重定向和转发"><br>SpringMVC 框架把原来 Servlet 中的请求转发和重定向操作进行了封装。现在可以使用简单的方式实现转发和重定向。</li><li>forward:表示转发，实现 request.getRequestDispatcher(“xx.jsp”).forward()</li><li>redirect:表示重定向，实现 response.sendRedirect(“xxx.jsp”)</li><li>forward和redirect都是关键字， 共同的特点：不和视图解析器一同工作</li><li>处理器方法可以返回ModelAndView, String , void 都可以使用forward，redirect</li><li>语法：setViewName(“redirect/forword:视图完整路径”)</li></ul><h3 id="框架对重定向的操作："><a href="#框架对重定向的操作：" class="headerlink" title="框架对重定向的操作："></a>框架对重定向的操作：</h3><ol><li><p>框架会把Model中的简单类型的数据，转为string使用，作为hello.jsp的get请求参数使用。目的是在<br>doRedirect.do 和 hello.jsp 两次请求之间传递数据</p></li><li><p>在目标hello.jsp页面可以使用参数集合对象 ${param}获取请求参数值   <code>${param.myname}</code></p></li><li><p>重定向不能访问/WEB-INF资源</p></li></ol><h2 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a>异常处理</h2><ul><li>springmvc框架采用的是统一，全局的异常处理。<br>把controller中的所有异常处理都集中到一个地方。采用的是aop的思想。把业务逻辑和异常处理代码分开，解耦合。</li><li>处理异常的方法和控制器方法的定义一样， 可以有多个参数，可以有ModelAndView,String, void,对象类型的返回值</li></ul><h3 id="ControllerAdvice"><a href="#ControllerAdvice" class="headerlink" title="@ControllerAdvice"></a>@ControllerAdvice</h3><ul><li>控制器增强（也就是说给控制器类增加功能–异常处理功能）<br> <strong>位置</strong>：在类的上面。<br> <strong>特点</strong>：必须让框架知道这个注解所在的包名，需要在springmvc配置文件声明组件扫描器。指定@ControllerAdvice所在的包名</li></ul><h3 id="ExceptionHandler"><a href="#ExceptionHandler" class="headerlink" title="@ExceptionHandler"></a>@ExceptionHandler</h3><ul><li><strong>value</strong>: 指定异常，表示此异常发生时执行所在方法。<br>value没有值表示除指定外的异常执行所在的方法，只能有一个。</li><li><strong>形参</strong>：Exception，表示Controller中抛出的异常对象。通过形参可以获取发生的异常信息。</li><li>异常发生处理逻辑：<br>1）需要把异常记录下来， 记录到数据库，日志文件。记录日志发生的时间，哪个方法发生的，异常错误内容。<br>2）发送通知，把异常的信息通过邮件，短信，微信发送给相关人员。<br>3) 给用户友好的提示。</li></ul><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GlobalExceptionHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExceptionHandler</span>(value = NameException<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">    <span class="title">public</span> <span class="title">ModelAndView</span> <span class="title">doNameException</span>(<span class="title">Exception</span> <span class="title">exception</span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">        ModelAndView mv = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">        mv.addObject(<span class="string">"msg"</span>,<span class="string">"姓名必须是zs，其它用户不能访问"</span>);</span><br><span class="line">        mv.addObject(<span class="string">"ex"</span>,exception);</span><br><span class="line">        mv.setViewName(<span class="string">"nameError"</span>);</span><br><span class="line">        <span class="keyword">return</span> mv;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//处理AgeException</span></span><br><span class="line">    <span class="meta">@ExceptionHandler</span>(value = AgeException<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">    <span class="title">public</span> <span class="title">ModelAndView</span> <span class="title">doAgeException</span>(<span class="title">Exception</span> <span class="title">exception</span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">        ModelAndView mv = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">        mv.addObject(<span class="string">"msg"</span>,<span class="string">"你的年龄不能大于80"</span>);</span><br><span class="line">        mv.addObject(<span class="string">"ex"</span>,exception);</span><br><span class="line">        mv.setViewName(<span class="string">"ageError"</span>);</span><br><span class="line">        <span class="keyword">return</span> mv;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//处理其它异常， NameException, AgeException以外，不知类型的异常</span></span><br><span class="line">    <span class="meta">@ExceptionHandler</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">doOtherException</span><span class="params">(Exception exception)</span></span>&#123;</span><br><span class="line">        <span class="comment">//处理其它异常</span></span><br><span class="line">        ModelAndView mv = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">        mv.addObject(<span class="string">"msg"</span>,<span class="string">"你的年龄不能大于80"</span>);</span><br><span class="line">        mv.addObject(<span class="string">"ex"</span>,exception);</span><br><span class="line">        mv.setViewName(<span class="string">"defaultError"</span>);</span><br><span class="line">        <span class="keyword">return</span> mv;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">jsp--$&#123;ex.message&#125;</span><br></pre></td></tr></table></figure><h2 id="拦截器"><a href="#拦截器" class="headerlink" title="拦截器"></a>拦截器</h2><ol><li>拦截器是springmvc中的一种，需要实现HandlerInterceptor接口。</li><li>拦截器和过滤器类似，功能方向侧重点不同。 过滤器是用来过滤器请求参数，设置编码字符集等工作。<br>拦截器是拦截用户的请求，做请求做判断处理的。</li><li>拦截器是全局的，可以对多个Controller做拦截。<br>一个项目中可以有0个或多个拦截器， 他们在一起拦截用户的请求。</li></ol><ul><li>拦截器常用在：用户登录处理，权限检查， 记录日志。</li><li><code>拦截器：看做是多个Controller中公用的功能，集中到拦截器统一处理。使用的aop的思想</code></li></ul><h3 id="拦截器的使用步骤："><a href="#拦截器的使用步骤：" class="headerlink" title="拦截器的使用步骤："></a>拦截器的使用步骤：</h3><ol><li>定义类实现HandlerInterceptor接口 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyInterceptor</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span> </span>&#123;</span><br></pre></td></tr></table></figure></li><li>在springmvc配置文件中，声明拦截器， 让框架知道拦截器的存在。 <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--声明第一个拦截器--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--指定拦截的请求uri地址</span></span><br><span class="line"><span class="comment">                path：就是uri地址，可以使用通配符 **</span></span><br><span class="line"><span class="comment">                      ** ： 表示任意的字符，文件或者多级目录和目录中的文件</span></span><br><span class="line"><span class="comment">            --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">"/**"</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--声明拦截器对象--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"com.bjpowernode.handler.MyInterceptor"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><h3 id="拦截器的执行时间："><a href="#拦截器的执行时间：" class="headerlink" title="拦截器的执行时间："></a>拦截器的执行时间：</h3><ol><li>在请求处理之前， 也就是controller类中的方法执行之前先被拦截。</li><li>在控制器方法执行之后也会执行拦截器。</li><li>在请求处理完成后也会执行拦截器。</li></ol><h3 id="拦截器实现的三个方法"><a href="#拦截器实现的三个方法" class="headerlink" title="拦截器实现的三个方法"></a>拦截器实现的三个方法</h3><h4 id="preHandle-–预处理方法"><a href="#preHandle-–预处理方法" class="headerlink" title="preHandle()–预处理方法"></a>preHandle()–预处理方法</h4><ul><li><p>重要：是整个项目的入口，门户。<br>当preHandle返回true 请求可以被处理。<br>preHandle返回false，请求到此方法就截止。</p></li><li><p>参数：<br>Object handler ：被拦截的控制器对象</p></li><li><p>返回值boolean<br>  <strong>true</strong>：请求是通过了拦截器的验证，可以执行处理器方法。<br>  <strong>false</strong>：请求没有通过拦截器的验证，请求到达拦截器就截止了。 请求没有被处理拦截器的MyInterceptor的preHandle()</p></li><li><p>特点：</p><ol><li>方法在控制器方法（MyController的doSome）之前先执行的。用户的请求首先到达此方法</li><li>在这个 方法中可以获取请求的信息， 验证请求是否符合要求。<br>可以验证用户是否登录， 验证用户是否有权限访问某个连接地址（url）。<br>如果验证失败，可以截断请求，请求不能被处理。<br>如果验证成功，可以放行请求，此时控制器方法才能执行。</li></ol></li></ul><h4 id="postHandle-–后处理方法"><a href="#postHandle-–后处理方法" class="headerlink" title="postHandle()–后处理方法"></a>postHandle()–后处理方法</h4><ul><li><p>参数：<br>Object handler：被拦截的处理器对象MyController<br>ModelAndView mv:处理器方法的返回值</p></li><li><p>特点：</p><ol><li>在处理器方法之后执行的（MyController.doSome()）</li><li>能够获取到处理器方法的返回值ModelAndView,可以修改ModelAndView中的数据和视图，可以影响到最后的执行结果。</li><li>主要是对原来的执行结果做二次修正，</li></ol></li></ul><h3 id="afterCompletion-–最后执行的方法"><a href="#afterCompletion-–最后执行的方法" class="headerlink" title="afterCompletion()–最后执行的方法"></a>afterCompletion()–最后执行的方法</h3><ul><li>参数<br>Object handler:被拦截器的处理器对象<br>Exception ex：程序中发生的异常</li><li>特点:<ol><li>在请求处理完成后执行的。框架中规定是当你的视图处理完成后，对视图执行了forward。就认为请求处理完成。<br>此时对 ModelAndView 再操作也对响应无济于事。</li><li>一般做资源回收工作的， 程序请求过程中创建了一些对象，在这里可以删除，把占用的内存回收。</li><li>当 preHandle()方法返回 true 时，会将该方法放到专门的方法栈中，等到对请求进行响应的所有工作完成之后才执行该方法。</li></ol></li></ul><h2 id="多个拦截器"><a href="#多个拦截器" class="headerlink" title="多个拦截器"></a>多个拦截器</h2><ul><li>多个拦截器中方法与处理器方法的执行顺序如下图：<br><img src="/blog-img/SpringMVC/%E5%A4%9A%E4%B8%AA%E6%8B%A6%E6%88%AA%E5%99%A8.jpg" alt=""><br>从图中可以看出，只要有一个 preHandle()方法返回 false，则上部的执行链将被断开，其后续的处理器方法<br>与 postHandle()方法将无法执行。但，无论执行链执行情况怎样，只要方法栈中有方法，即执行链中只要有<br>preHandle()方法返回 true，就会执行方法栈中的afterCompletion()方法。最终都会给出响应。</li></ul><h2 id="拦截器和过滤器的区别"><a href="#拦截器和过滤器的区别" class="headerlink" title="拦截器和过滤器的区别"></a>拦截器和过滤器的区别</h2><ol><li>过滤器是servlet中的对象，  拦截器是框架中的对象</li><li>过滤器实现Filter接口的对象， 拦截器是实现HandlerInterceptor</li><li>过滤器是用来设置request，response的参数，属性的，侧重对数据过滤的。<br>拦截器是用来验证请求的，能截断请求。</li><li>过滤器是在拦截器之前先执行的。</li><li>过滤器是tomcat服务器创建的对象<br>拦截器是springmvc容器中创建的对象</li><li>过滤器是一个执行时间点。<br>拦截器有三个执行时间点</li><li>过滤器可以处理jsp，js，html等等<br>拦截器是侧重拦截对Controller的对象。 如果你的请求不能被DispatcherServlet接收， 这个请求不会执行拦截器内容</li><li>拦截器拦截普通类方法执行，过滤器过滤servlet请求响应<h1 id="第3章-处理器方法补充"><a href="#第3章-处理器方法补充" class="headerlink" title="第3章 处理器方法补充"></a><center>第3章 处理器方法补充</center></h1></li></ol><h2 id="处理器方法的参数"><a href="#处理器方法的参数" class="headerlink" title="处理器方法的参数"></a>处理器方法的参数</h2><p>处理器方法可以包含以下四类参数，这些参数会在系统调用时由系统自动赋值，即程序员可在方法内直接使用。<br>➢ HttpServletRequest<br>➢ HttpServletResponse<br>➢ HttpSession<br>➢ 请求中所携带的请求参数</p><h3 id="逐个参数接收"><a href="#逐个参数接收" class="headerlink" title="逐个参数接收"></a>逐个参数接收</h3><p>逐个接收请求参数：<br>要求： 处理器（控制器）方法的形参名和请求中参数名必须一致。同名的请求参数赋值给同名的形参框架接收请求参数</p><ol><li><p>使用request对象接收请求参数<br>String strName = request.getParameter(“name”);<br>String strAge = request.getParameter(“age”);</p></li><li><p>springmvc框架通过 DispatcherServlet 调用 MyController的doSome()方法调用方法时，按名称对应，把接收的参数赋值给形参<br>doSome（strName，Integer.valueOf(strAge)）<br>框架会提供类型转换的功能，能把String转为 int ，long ， float， double等类型。</p><p>出现400客户端错误，是因为提交请求参数过程中，发生了问题。例如int类型接收了一个null。</p></li></ol><h3 id="对象参数接收"><a href="#对象参数接收" class="headerlink" title="对象参数接收"></a>对象参数接收</h3><ul><li>创建一个vo类，作为处理器方法形参，类的属性是请求中的参数名</li><li>请求过程中框架会创建java对象， 给属性赋值。 请求中的参数是name，框架会调用setName()</li></ul><h2 id="请求参数中文乱码问题"><a href="#请求参数中文乱码问题" class="headerlink" title="请求参数中文乱码问题"></a>请求参数中文乱码问题</h2><ul><li>在 web.xml 中注册字符集过滤器，即可解决 Spring 的请求参数的中文乱码问题。不过，<br>最好将该过滤器注册在其它过滤器之前。因为过滤器的执行是按照其注册顺序进行的。<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--注册声明过滤器，解决post请求乱码的问题--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>characterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--设置项目中使用的字符编码--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--强制请求对象（HttpServletRequest）使用encoding编码的值--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceRequestEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--强制应答对象（HttpServletResponse）使用encoding编码的值--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceResponseEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>characterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">       /*:表示强制所有的请求先通过过滤器处理。</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><h2 id="处理器方法的返回值"><a href="#处理器方法的返回值" class="headerlink" title="处理器方法的返回值"></a>处理器方法的返回值</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyController</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 处理器方法返回String--表示逻辑视图名称，需要配置视图解析器</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/returnString-view.do"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">doReturnView</span><span class="params">(HttpServletRequest request, String name, Integer age)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"doReturnView, name="</span>+name+<span class="string">"   age="</span>+age);</span><br><span class="line">        <span class="comment">//可以自己手工添加数据到request作用域</span></span><br><span class="line">        request.setAttribute(<span class="string">"myName"</span>,name);</span><br><span class="line">        request.setAttribute(<span class="string">"myAge"</span>,age);</span><br><span class="line">        <span class="comment">// show : 逻辑视图名称，项目中配置了视图解析器</span></span><br><span class="line">        <span class="comment">// 框架对视图执行forward转发操作</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"show"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//处理器方法返回String,表示完整视图路径的时候， 此时不能配置视图解析器</span></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/returnString-view2.do"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">doReturnView2</span><span class="params">(HttpServletRequest request,String name, Integer age)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"===doReturnView2====, name="</span>+name+<span class="string">"   age="</span>+age);</span><br><span class="line">        <span class="comment">//可以自己手工添加数据到request作用域</span></span><br><span class="line">        request.setAttribute(<span class="string">"myName"</span>,name);</span><br><span class="line">        request.setAttribute(<span class="string">"myAge"</span>,age);</span><br><span class="line">        <span class="comment">// 完整视图路径，项目中不能配置视图解析器</span></span><br><span class="line">        <span class="comment">// 框架对视图执行forward转发操作</span></span><br><span class="line">        <span class="comment">// /WEB-INF/view//WEB-INF/view/show.jsp.jsp</span></span><br><span class="line">        <span class="comment">// /WEB-INF/view/WEB-INF/view/show.jsp.jsp</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"/WEB-INF/view/show.jsp"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//处理器方法返回void， 响应ajax请求</span></span><br><span class="line">    <span class="comment">//手工实现ajax，json数据： 代码有重复的 1. java对象转为json； 2. 通过HttpServletResponse输出json数据</span></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/returnVoid-ajax.do"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doReturnVoidAjax</span><span class="params">(HttpServletResponse response, String name, Integer age)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"===doReturnVoidAjax====, name="</span>+name+<span class="string">"   age="</span>+age);</span><br><span class="line">        <span class="comment">//处理ajax， 使用json做数据的格式</span></span><br><span class="line">        <span class="comment">//service调用完成了， 使用Student表示处理结果</span></span><br><span class="line">        Student student  = <span class="keyword">new</span> Student();</span><br><span class="line">        student.setName(<span class="string">"张飞同学"</span>);</span><br><span class="line">        student.setAge(<span class="number">28</span>);</span><br><span class="line"></span><br><span class="line">        String json = <span class="string">""</span>;</span><br><span class="line">        <span class="comment">//把结果的对象转为json格式的数据</span></span><br><span class="line">        <span class="keyword">if</span>( student != <span class="keyword">null</span>)&#123;</span><br><span class="line">            ObjectMapper om  = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line">            json  = om.writeValueAsString(student);</span><br><span class="line">            System.out.println(<span class="string">"student转换的json===="</span>+json);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//输出数据，响应ajax的请求</span></span><br><span class="line">        response.setContentType(<span class="string">"application/json;charset=utf-8"</span>);</span><br><span class="line">        PrintWriter pw  = response.getWriter();</span><br><span class="line">        pw.println(json);</span><br><span class="line">        pw.flush();</span><br><span class="line">        pw.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 处理器方法返回一个Student，通过框架转为json，响应ajax请求</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@ResponseBody</span>:</span></span><br><span class="line"><span class="comment">     *    作用：把处理器方法返回对象转为json后，通过HttpServletResponse输出给浏览器。</span></span><br><span class="line"><span class="comment">     *    位置：方法的定义上面。 和其它注解没有顺序的关系。</span></span><br><span class="line"><span class="comment">     * 返回对象框架的处理流程：</span></span><br><span class="line"><span class="comment">     *  1. 框架会把返回Student类型，调用框架的中ArrayList&lt;HttpMessageConverter&gt;中每个类的canWrite()方法</span></span><br><span class="line"><span class="comment">     *     检查那个HttpMessageConverter接口的实现类能处理Student类型的数据--MappingJackson2HttpMessageConverter</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *  2.框架会调用实现类的write（）， MappingJackson2HttpMessageConverter的write()方法</span></span><br><span class="line"><span class="comment">     *    把李四同学的student对象转为json， 调用Jackson的ObjectMapper实现转为json</span></span><br><span class="line"><span class="comment">     *    contentType: application/json;charset=utf-8</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *  3.框架会调用<span class="doctag">@ResponseBody</span>把2的结果数据输出到浏览器， ajax请求处理完成</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/returnStudentJson.do"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Student <span class="title">doStudentJsonObject</span><span class="params">(String name, Integer age)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//调用service，获取请求结果数据 ， Student对象表示结果数据</span></span><br><span class="line">        Student student = <span class="keyword">new</span> Student();</span><br><span class="line">        student.setName(<span class="string">"李四同学"</span>);</span><br><span class="line">        student.setAge(<span class="number">20</span>);</span><br><span class="line">        <span class="keyword">return</span> student; <span class="comment">// 会被框架转为json</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  处理器方法返回List&lt;Student&gt;</span></span><br><span class="line"><span class="comment">     * 返回对象框架的处理流程：</span></span><br><span class="line"><span class="comment">     *  1. 框架会把返回List&lt;Student&gt;类型，调用框架的中ArrayList&lt;HttpMessageConverter&gt;中每个类的canWrite()方法</span></span><br><span class="line"><span class="comment">     *     检查那个HttpMessageConverter接口的实现类能处理Student类型的数据--MappingJackson2HttpMessageConverter</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *  2.框架会调用实现类的write（）， MappingJackson2HttpMessageConverter的write()方法</span></span><br><span class="line"><span class="comment">     *    把李四同学的student对象转为json， 调用Jackson的ObjectMapper实现转为json array</span></span><br><span class="line"><span class="comment">     *    contentType: application/json;charset=utf-8</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *  3.框架会调用<span class="doctag">@ResponseBody</span>把2的结果数据输出到浏览器， ajax请求处理完成</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/returnStudentJsonArray.do"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Student&gt; <span class="title">doStudentJsonObjectArray</span><span class="params">(String name, Integer age)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        List&lt;Student&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="comment">//调用service，获取请求结果数据 ， Student对象表示结果数据</span></span><br><span class="line">        Student student = <span class="keyword">new</span> Student();</span><br><span class="line">        student.setName(<span class="string">"李四同学"</span>);</span><br><span class="line">        student.setAge(<span class="number">20</span>);</span><br><span class="line">        list.add(student);</span><br><span class="line"></span><br><span class="line">        student = <span class="keyword">new</span> Student();</span><br><span class="line">        student.setName(<span class="string">"张三"</span>);</span><br><span class="line">        student.setAge(<span class="number">28</span>);</span><br><span class="line">        list.add(student);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 处理器方法返回的是String ， String表示数据的，不是视图。</span></span><br><span class="line"><span class="comment">     * 区分返回值String是数据，还是视图，看有没有<span class="doctag">@ResponseBody</span>注解</span></span><br><span class="line"><span class="comment">     * 如果有<span class="doctag">@ResponseBody</span>注解，返回String就是数据，反之就是视图</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * 默认使用“text/plain;charset=ISO-8859-1”作为contentType,导致中文有乱码，</span></span><br><span class="line"><span class="comment">     * 解决方案：给RequestMapping增加一个属性 produces, 使用这个属性指定新的contentType.</span></span><br><span class="line"><span class="comment">     * 返回对象框架的处理流程：</span></span><br><span class="line"><span class="comment">     *  1. 框架会把返回String类型，调用框架的中ArrayList&lt;HttpMessageConverter&gt;中每个类的canWrite()方法</span></span><br><span class="line"><span class="comment">     *     检查那个HttpMessageConverter接口的实现类能处理String类型的数据--StringHttpMessageConverter</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *  2.框架会调用实现类的write（）， StringHttpMessageConverter的write()方法</span></span><br><span class="line"><span class="comment">     *    把字符按照指定的编码处理 text/plain;charset=utf-8</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *  3.框架会调用<span class="doctag">@ResponseBody</span>把2的结果数据输出到浏览器， ajax请求处理完成</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/returnStringData.do"</span>,produces = <span class="string">"text/plain;charset=utf-8"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">doStringData</span><span class="params">(String name,Integer age)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello SpringMVC 返回对象，表示数据成功"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>加入注解驱动<code>&lt;mvc:annotation-driven/&gt;</code>后适配器类的 messageConverters 属性值<br><img src="/blog-img/SpringMVC/msg.jpg" alt=""><br><img src="/blog-img/SpringMVC/HttpMessageConverter.jpg" alt=""></li></ul><h2 id="静态资源的处理"><a href="#静态资源的处理" class="headerlink" title="静态资源的处理"></a>静态资源的处理</h2><ul><li>在没有特殊要求的情况下，SpringMVC 的中央调度器 DispatcherServlet 的<code>&lt;url-pattern/&gt;</code><br>常使用后辍匹配方式，如写为<code>*.do</code> 或者<code>*.action, *.mvc</code> 等。<br>当使用<code>/</code>时 DispatcherServlet 会将向静态资源的获取请求，当作是一个普通的 Controller 请求。中央调度器会调用处理器映射器为其查找相应的处理器。<br>当然也是找不到的，所以在这种情况下，所有的静态资源获取请求也均会报 404 错误。</li></ul><p><strong>解决方法</strong>：</p><ol><li>使用<code>&lt;mvc:default-servlet-handler/&gt;</code> 注册tomcat的默认servlet<br>tomcat的web.xml文件有一个servlet名称是default ，在服务器启动时创建的，这个servlet能处理静态资源的访问</li><li>使用<code>&lt;mvc:resources/&gt;</code>（掌握）<br>当服务器不是tomcat没有默认的servlet时，可以载springmvc配置文件中加入<code>&lt;mvc:resources/&gt;</code>专门用于处理静态资源访问请求<br> <code>&lt;mvc:resources mapping=&quot;/static/&quot; location=&quot;/static/** &quot;/&gt;</code><ul><li>location 表示静态资源所在目录。当然，目录不要使用/WEB-INF/及其子目录。</li><li>mapping 表 示 对 该 资 源 的 请 求 （ 以 <code>/static/</code>开 始 的 请 求 ， 如<code>/static/beauty.jpg</code> , <code>/static/car.png</code> 等）。注意，后面是两个星号<code>**</code>。</li></ul></li><li>声明注解驱动</li></ol><ul><li>有静态资源访问就要加<code>&lt;mvc:annotation-driven /&gt;</code></li></ul><h2 id="path"><a href="#path" class="headerlink" title="path"></a>path</h2><ul><li>动态设置当前页面的所有链接规定默认地址或默认目标  <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">contentType</span>=<span class="string">"text/html;charset=UTF-8"</span> <span class="attr">language</span>=<span class="string">"java"</span> %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span></span></span><br><span class="line"><span class="tag">    <span class="attr">String</span> <span class="attr">basePath</span> = <span class="string">request.getScheme()</span> + "<span class="attr">:</span>//" +</span></span><br><span class="line"><span class="tag">            <span class="attr">request.getServerName</span>() + "<span class="attr">:</span>" + <span class="attr">request.getServerPort</span>() +</span></span><br><span class="line"><span class="tag">            <span class="attr">request.getContextPath</span>() + "/";</span></span><br><span class="line"><span class="tag">%&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">base</span> <span class="attr">href</span>=<span class="string">"&lt;%=basePath%&gt;"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">p</span>&gt;</span>第一个springmvc项目<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"user/some.do"</span>&gt;</span>发起user/some.do的get请求<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><h1 id="第4章-SSM整合"><a href="#第4章-SSM整合" class="headerlink" title="第4章 SSM整合"></a><center>第4章 SSM整合</center></h1><ul><li><p>SSM：SpringMVC 、 Spring 、 MyBatis.<br>SpringMVC:视图层，界面层，负责接收请求，显示处理结果的。<br>Spring：业务层，管理service，dao，工具类对象的。<br>MyBatis：持久层， 访问数据库的</p></li><li><p>用户发起请求–SpringMVC接收–Spring中的Service对象–MyBatis处理数据</p></li><li><p>SSM整合也叫做SSI (IBatis也就是mybatis的前身)， 整合中有容器。</p><ol><li>第一个容器SpringMVC容器， 管理Controller控制器对象的。</li><li>第二个容器Spring容器，管理Service，Dao,工具类对象的</li></ol></li><li><p>我们要做的把使用的对象交给合适的容器创建，管理。 </p><ol><li>把Controller还有web开发的相关对象交给springmvc容器，这些web用的对象写在springmvc配置文件中</li><li>service，dao对象定义在spring的配置文件中，让spring管理这些对象。</li></ol></li></ul><blockquote><p>springmvc容器是spring容器的子容器， 类似java中的继承。 子可以访问父的内容在子容器中的<br>Controller可以访问父容器中的Service对象， 就可以实现controller使用service对象</p></blockquote><h2 id="实现步骤"><a href="#实现步骤" class="headerlink" title="实现步骤"></a>实现步骤</h2><h3 id="准备数据库表"><a href="#准备数据库表" class="headerlink" title="准备数据库表"></a>准备数据库表</h3><h3 id="新建maven-web项目-1"><a href="#新建maven-web项目-1" class="headerlink" title="新建maven web项目"></a>新建maven web项目</h3><h3 id="加入依赖"><a href="#加入依赖" class="headerlink" title="加入依赖"></a>加入依赖</h3><ul><li>springmvc，spring，mybatis三个框架的依赖，jackson依赖，mysql驱动，druid连接池，jsp，servlet依赖  <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.11<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet.jsp<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jsp-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.1-b03<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.5.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-tx<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.5.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.5.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="写web-xml"><a href="#写web-xml" class="headerlink" title="写web.xml"></a>写web.xml</h3><ol><li><p>注册DispatcherServlet ,目的：<br> 1)创建springmvc容器对象，才能创建Controller类对象。<br> 2)创建的是Servlet，才能接受用户的请求。</p></li><li><p>注册spring的监听器：ContextLoaderListener,目的： 创建spring的容器对象，才能创建service，dao等对象。</p></li><li><p>注册字符集过滤器，解决post请求乱码的问题</p> <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">"4.0"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!--注册中央调度器--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>myweb<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:conf/dispatcherServlet.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>myweb<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>*.do<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!--注册spring的监听器--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:conf/applicationContext.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!--注册字符集过滤器--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>characterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceRequestEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceResponseEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>characterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><h3 id="创建包，-Controller包，-service-，dao，实体类包名创建好"><a href="#创建包，-Controller包，-service-，dao，实体类包名创建好" class="headerlink" title="创建包， Controller包， service ，dao，实体类包名创建好"></a>创建包， Controller包， service ，dao，实体类包名创建好</h3><p><img src="/blog-img/SpringMVC/%E5%8C%85%E7%BB%93%E6%9E%84.jpg" alt=""></p><h3 id="写springmvc，spring，mybatis的配置文件"><a href="#写springmvc，spring，mybatis的配置文件" class="headerlink" title="写springmvc，spring，mybatis的配置文件"></a>写springmvc，spring，mybatis的配置文件</h3><ol><li>springmvc配置文件 <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/mvc https://www.springframework.org/schema/mvc/spring-mvc.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--springmvc配置文件， 声明controller和其它web相关的对象--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"cn.JInterest.controller"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/jsp/"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:annotation-driven</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">      1. 响应ajax请求，返回json</span></span><br><span class="line"><span class="comment">      2. 解决静态资源访问问题。</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li>spring配置文件 <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--spring配置文件： 声明service，dao，工具类等对象--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">"classpath:conf/jdbc.properties"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--声明数据源，连接数据库--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"com.alibaba.druid.pool.DruidDataSource"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">init-method</span>=<span class="string">"init"</span> <span class="attr">destroy-method</span>=<span class="string">"close"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.url&#125;"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.username&#125;"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.passwd&#125;"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--SqlSessionFactoryBean创建SqlSessionFactory--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"configLocation"</span>  <span class="attr">value</span>=<span class="string">"classpath:conf/mybatis.xml"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--声明mybatis的扫描器，创建dao对象--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sqlSessionFactoryBeanName"</span> <span class="attr">value</span>=<span class="string">"sqlSessionFactory"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"basePackage"</span> <span class="attr">value</span>=<span class="string">"cn.JInterest.dao"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--声明service的注解@Service所在的包名位置--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"cn.JInterest.service"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--事务配置：注解的配置， aspectj的配置--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li>mybatis主配置文件 <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--settings：控制mybatis全局行为--&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- &lt;settings&gt;</span></span><br><span class="line"><span class="comment">        &amp;lt;!&amp;ndash;设置mybatis输出日志&amp;ndash;&amp;gt;</span></span><br><span class="line"><span class="comment">        &lt;setting name="logImpl" value="STDOUT_LOGGING"/&gt;</span></span><br><span class="line"><span class="comment">    &lt;/settings&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--设置别名--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--name:实体类所在的包名(不是实体类的包名也可以)--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"cn.JInterest.domain"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- sql mapper(sql映射文件)的位置--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">          name：是包名， 这个包中的所有mapper.xml一次都能加载</span></span><br><span class="line"><span class="comment">          使用package的要求：</span></span><br><span class="line"><span class="comment">           1. mapper文件名称和dao接口名必须完全一样，包括大小写</span></span><br><span class="line"><span class="comment">           2. mapper文件和dao接口必须在同一目录</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"cn.JInterest.dao"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li>数据库的属性配置文件 <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">jdbc.url&#x3D;jdbc:mysql:&#x2F;&#x2F;localhost:3306&#x2F;springdb?useUnicode&#x3D;true&amp;characterEncoding&#x3D;utf-8&amp;serverTimezone&#x3D;GMT</span><br><span class="line">jdbc.username&#x3D;</span><br><span class="line">jdbc.passwd&#x3D;</span><br></pre></td></tr></table></figure><h3 id="写代码，-dao接口和mapper文件，-service和实现类，controller，-实体类。"><a href="#写代码，-dao接口和mapper文件，-service和实现类，controller，-实体类。" class="headerlink" title="写代码， dao接口和mapper文件， service和实现类，controller， 实体类。"></a>写代码， dao接口和mapper文件， service和实现类，controller， 实体类。</h3></li></ol><h3 id="写jsp页面"><a href="#写jsp页面" class="headerlink" title="写jsp页面"></a>写jsp页面</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">contentType</span>=<span class="string">"text/html;charset=UTF-8"</span> <span class="attr">language</span>=<span class="string">"java"</span> %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span></span></span><br><span class="line"><span class="tag">    <span class="attr">String</span> <span class="attr">basePath</span> = <span class="string">request.getScheme()</span> + "<span class="attr">:</span>//" +</span></span><br><span class="line"><span class="tag">            <span class="attr">request.getServerName</span>() + "<span class="attr">:</span>" + <span class="attr">request.getServerPort</span>() +</span></span><br><span class="line"><span class="tag">            <span class="attr">request.getContextPath</span>() + "/";</span></span><br><span class="line"><span class="tag">%&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>查询学生ajax<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">base</span> <span class="attr">href</span>=<span class="string">"&lt;%=basePath%&gt;"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"js/jquery-3.4.1.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="javascript">        $(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="actionscript">            <span class="comment">//在当前页面dom对象加载后，执行loadStudentData（）</span></span></span><br><span class="line">            loadStudentData();</span><br><span class="line"><span class="javascript">            $(<span class="string">"#btnLoader"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line">                loadStudentData();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line"><span class="actionscript">        <span class="function"><span class="keyword">function</span> <span class="title">loadStudentData</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="javascript">            $.ajax(&#123;</span></span><br><span class="line"><span class="actionscript">                url:<span class="string">"student/queryStudent.do"</span>,</span></span><br><span class="line"><span class="actionscript">                type:<span class="string">"get"</span>,</span></span><br><span class="line"><span class="actionscript">                dataType:<span class="string">"json"</span>,</span></span><br><span class="line"><span class="actionscript">                success:<span class="function"><span class="keyword">function</span><span class="params">(data)</span></span>&#123;</span></span><br><span class="line"><span class="actionscript">                    <span class="comment">//清除旧的数据</span></span></span><br><span class="line"><span class="javascript">                    $(<span class="string">"#info"</span>).html(<span class="string">""</span>);</span></span><br><span class="line"><span class="actionscript">                    <span class="comment">//增加新的数据</span></span></span><br><span class="line"><span class="javascript">                    $.each(data,<span class="function"><span class="keyword">function</span>(<span class="params">i,n</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                        $(<span class="string">"#info"</span>).append(<span class="string">"&lt;tr&gt;"</span>)</span></span><br><span class="line"><span class="actionscript">                            .append(<span class="string">"&lt;td&gt;"</span>+n.id+<span class="string">"&lt;/td&gt;"</span>)</span></span><br><span class="line"><span class="actionscript">                            .append(<span class="string">"&lt;td&gt;"</span>+n.name+<span class="string">"&lt;/td&gt;"</span>)</span></span><br><span class="line"><span class="actionscript">                            .append(<span class="string">"&lt;td&gt;"</span>+n.email+<span class="string">"&lt;/td&gt;"</span>)</span></span><br><span class="line"><span class="actionscript">                            .append(<span class="string">"&lt;td&gt;"</span>+n.age+<span class="string">"&lt;/td&gt;"</span>)</span></span><br><span class="line"><span class="actionscript">                            .append(<span class="string">"&lt;/tr&gt;"</span>)</span></span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">align</span>=<span class="string">"center"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">"1"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">td</span>&gt;</span>学号<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">td</span>&gt;</span>姓名<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">td</span>&gt;</span>邮箱<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">td</span>&gt;</span>年龄<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tbody</span> <span class="attr">id</span>=<span class="string">"info"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">id</span>=<span class="string">"btnLoader"</span> <span class="attr">value</span>=<span class="string">"刷新数据"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> java框架 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java框架 </tag>
            
            <tag> SpringMVC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTTP状态码</title>
      <link href="/posts/HTTPStatusCode/"/>
      <url>/posts/HTTPStatusCode/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\css\APlayer.min.css"><script src="\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\js\Meting.min.js"></script><h1 id="消息"><a href="#消息" class="headerlink" title="消息"></a>消息</h1><ul><li>这一类型的状态码，代表请求已被接受，需要继续处理。这类响应是临时响应，只包含状态行和某些可选的响应头信息，并以空行结束。由于 HTTP/1.0 协议中没有定义任何 1xx 状态码，所以除非在某些试验条件下，服务器禁止向此类客户端发送 1xx 响应。</li></ul><h2 id="100-Continue"><a href="#100-Continue" class="headerlink" title="100 Continue"></a>100 Continue</h2><p>客户端应当继续发送请求。这个临时响应是用来通知客户端它的部分请求已经被服务器接收，且仍未被拒绝。客户端应当继续发送请求的剩余部分，或者如果请求已经完成，忽略这个响应。服务器必须在请求完成后向客户端发送一个最终响应。</p><h2 id="101-Switching-Protocols"><a href="#101-Switching-Protocols" class="headerlink" title="101 Switching Protocols"></a>101 Switching Protocols</h2><p>服务器已经理解了客户端的请求，并将通过Upgrade 消息头通知客户端采用不同的协议来完成这个请求。在发送完这个响应最后的空行后，服务器将会切换到在Upgrade 消息头中定义的那些协议。<br>只有在切换新的协议更有好处的时候才应该采取类似措施。例如，切换到新的HTTP 版本比旧版本更有优势，或者切换到一个实时且同步的协议以传送利用此类特性的资源。</p><h2 id="102-Processing"><a href="#102-Processing" class="headerlink" title="102 Processing"></a>102 Processing</h2><p>由WebDAV（RFC 2518）扩展的状态码，代表处理将被继续执行。</p><h1 id="成功"><a href="#成功" class="headerlink" title="成功"></a>成功</h1><ul><li>这一类型的状态码，代表请求已成功被服务器接收、理解、并接受。</li></ul><h2 id="200-OK"><a href="#200-OK" class="headerlink" title="200 OK"></a>200 OK</h2><p>请求已成功，请求所希望的响应头或数据体将随此响应返回。出现此状态码是表示正常状态。</p><h2 id="201-Created"><a href="#201-Created" class="headerlink" title="201 Created"></a>201 Created</h2><p>请求已经被实现，而且有一个新的资源已经依据请求的需要而建立，且其 URI 已经随Location 头信息返回。假如需要的资源无法及时建立的话，应当返回 ‘202 Accepted’。</p><h2 id="202-Accepted"><a href="#202-Accepted" class="headerlink" title="202 Accepted"></a>202 Accepted</h2><p>服务器已接受请求，但尚未处理。正如它可能被拒绝一样，最终该请求可能会也可能不会被执行。在异步操作的场合下，没有比发送这个状态码更方便的做法了。<br>返回202状态码的响应的目的是允许服务器接受其他过程的请求（例如某个每天只执行一次的基于批处理的操作），而不必让客户端一直保持与服务器的连接直到批处理操作全部完成。在接受请求处理并返回202状态码的响应应当在返回的实体中包含一些指示处理当前状态的信息，以及指向处理状态监视器或状态预测的指针，以便用户能够估计操作是否已经完成。</p><h2 id="203-Non-Authoritative-Information"><a href="#203-Non-Authoritative-Information" class="headerlink" title="203 Non-Authoritative Information"></a>203 Non-Authoritative Information</h2><p>服务器已成功处理了请求，但返回的实体头部元信息不是在原始服务器上有效的确定集合，而是来自本地或者第三方的拷贝。当前的信息可能是原始版本的子集或者超集。例如，包含资源的元数据可能导致原始服务器知道元信息的超集。使用此状态码不是必须的，而且只有在响应不使用此状态码便会返回200 OK的情况下才是合适的。</p><h2 id="204-No-Content"><a href="#204-No-Content" class="headerlink" title="204 No Content"></a>204 No Content</h2><p>服务器成功处理了请求，但不需要返回任何实体内容，并且希望返回更新了的元信息。响应可能通过实体头部的形式，返回新的或更新后的元信息。如果存在这些头部信息，则应当与所请求的变量相呼应。<br>如果客户端是浏览器的话，那么用户浏览器应保留发送了该请求的页面，而不产生任何文档视图上的变化，即使按照规范新的或更新后的元信息应当被应用到用户浏览器活动视图中的文档。<br>由于204响应被禁止包含任何消息体，因此它始终以消息头后的第一个空行结尾。</p><h2 id="205-Reset-Content"><a href="#205-Reset-Content" class="headerlink" title="205 Reset Content"></a>205 Reset Content</h2><p>服务器成功处理了请求，且没有返回任何内容。但是与204响应不同，返回此状态码的响应要求请求者重置文档视图。该响应主要是被用于接受用户输入后，立即重置表单，以便用户能够轻松地开始另一次输入。<br>与204响应一样，该响应也被禁止包含任何消息体，且以消息头后的第一个空行结束。</p><h2 id="206-Partial-Content"><a href="#206-Partial-Content" class="headerlink" title="206 Partial Content"></a>206 Partial Content</h2><p>服务器已经成功处理了部分 GET 请求。类似于 FlashGet 或者迅雷这类的 HTTP下载工具都是使用此类响应实现断点续传或者将一个大文档分解为多个下载段同时下载。<br>该请求必须包含 Range 头信息来指示客户端希望得到的内容范围，并且可能包含 If-Range 来作为请求条件。<br>响应必须包含如下的头部域：<br>Content-Range 用以指示本次响应中返回的内容的范围；如果是 Content-Type 为 multipart/byteranges 的多段下载，则每一 multipart 段中都应包含 Content-Range 域用以指示本段的内容范围。假如响应中包含 Content-Length，那么它的数值必须匹配它返回的内容范围的真实字节数。<br>Date<br>ETag 和/或 Content-Location，假如同样的请求本应该返回200响应。<br>Expires, Cache-Control，和/或 Vary，假如其值可能与之前相同变量的其他响应对应的值不同的话。<br>假如本响应请求使用了 If-Range 强缓存验证，那么本次响应不应该包含其他实体头；假如本响应的请求使用了 If-Range 弱缓存验证，那么本次响应禁止包含其他实体头；这避免了缓存的实体内容和更新了的实体头信息之间的不一致。否则，本响应就应当包含所有本应该返回200响应中应当返回的所有实体头部域。<br>假如 ETag 或 Last-Modified 头部不能精确匹配的话，则客户端缓存应禁止将206响应返回的内容与之前任何缓存过的内容组合在一起。</p><h2 id="207-Multi-Status"><a href="#207-Multi-Status" class="headerlink" title="207 Multi-Status"></a>207 Multi-Status</h2><p>由WebDAV(RFC 2518)扩展的状态码，代表之后的消息体将是一个XML消息，并且可能依照之前子请求数量的不同，包含一系列独立的响应代码。</p><h1 id="重定向"><a href="#重定向" class="headerlink" title="重定向"></a>重定向</h1><ul><li>这类状态码代表需要客户端采取进一步的操作才能完成请求。通常，这些状态码用来重定向，后续的请求地址（重定向目标）在本次响应的 Location 域中指明。<br>当且仅当后续的请求所使用的方法是 GET 或者 HEAD 时，用户浏览器才可以在没有用户介入的情况下自动提交所需要的后续请求。客户端应当自动监测无限循环重定向（例如：A-&gt;A，或者A-&gt;B-&gt;C-&gt;A），因为这会导致服务器和客户端大量不必要的资源消耗。按照 HTTP/1.0 版规范的建议，浏览器不应自动访问超过5次的重定向。</li></ul><h2 id="300-Multiple-Choices"><a href="#300-Multiple-Choices" class="headerlink" title="300 Multiple Choices"></a>300 Multiple Choices</h2><p>被请求的资源有一系列可供选择的回馈信息，每个都有自己特定的地址和浏览器驱动的商议信息。用户或浏览器能够自行选择一个首选的地址进行重定向。<br>除非这是一个 HEAD 请求，否则该响应应当包括一个资源特性及地址的列表的实体，以便用户或浏览器从中选择最合适的重定向地址。这个实体的格式由 Content-Type 定义的格式所决定。浏览器可能根据响应的格式以及浏览器自身能力，自动作出最合适的选择。当然，RFC 2616规范并没有规定这样的自动选择该如何进行。<br>如果服务器本身已经有了首选的回馈选择，那么在 Location 中应当指明这个回馈的 URI；浏览器可能会将这个 Location 值作为自动重定向的地址。此外，除非额外指定，否则这个响应也是可缓存的。</p><h2 id="301-Moved-Permanently"><a href="#301-Moved-Permanently" class="headerlink" title="301 Moved Permanently"></a>301 Moved Permanently</h2><p>被请求的资源已永久移动到新位置，并且将来任何对此资源的引用都应该使用本响应返回的若干个 URI 之一。如果可能，拥有链接编辑功能的客户端应当自动把请求的地址修改为从服务器反馈回来的地址。除非额外指定，否则这个响应也是可缓存的。<br>新的永久性的URI 应当在响应的 Location 域中返回。除非这是一个 HEAD 请求，否则响应的实体中应当包含指向新的 URI 的超链接及简短说明。<br>如果这不是一个 GET 或者 HEAD 请求，因此浏览器禁止自动进行重定向，除非得到用户的确认，因为请求的条件可能因此发生变化。<br>注意：对于某些使用 HTTP/1.0 协议的浏览器，当它们发送的 POST 请求得到了一个301响应的话，接下来的重定向请求将会变成 GET 方式。</p><h2 id="302-Move-Temporarily"><a href="#302-Move-Temporarily" class="headerlink" title="302 Move Temporarily"></a>302 Move Temporarily</h2><p>请求的资源临时从不同的 URI响应请求。由于这样的重定向是临时的，客户端应当继续向原有地址发送以后的请求。只有在Cache-Control或Expires中进行了指定的情况下，这个响应才是可缓存的。<br>上文有提及。<br>如果这不是一个 GET 或者 HEAD 请求，那么浏览器禁止自动进行重定向，除非得到用户的确认，因为请求的条件可能因此发生变化。<br>注意：虽然RFC 1945和RFC 2068规范不允许客户端在重定向时改变请求的方法，但是很多现存的浏览器将302响应视作为303响应，并且使用 GET 方式访问在 Location 中规定的 URI，而无视原先请求的方法。状态码303和307被添加了进来，用以明确服务器期待客户端进行何种反应。</p><h2 id="303-See-Other"><a href="#303-See-Other" class="headerlink" title="303 See Other"></a>303 See Other</h2><p>对应当前请求的响应可以在另一个 URL 上被找到，而且客户端应当采用 GET 的方式访问那个资源。这个方法的存在主要是为了允许由脚本激活的POST请求输出重定向到一个新的资源。这个新的 URI 不是原始资源的替代引用。同时，303响应禁止被缓存。当然，第二个请求（重定向）可能被缓存。<br>注意：许多 HTTP/1.1 版以前的浏览器不能正确理解303状态。如果需要考虑与这些浏览器之间的互动，302状态码应该可以胜任，因为大多数的浏览器处理302响应时的方式恰恰就是上述规范要求客户端处理303响应时应当做的。</p><h2 id="304-Not-Modified"><a href="#304-Not-Modified" class="headerlink" title="304 Not Modified"></a>304 Not Modified</h2><p>如果客户端发送了一个带条件的 GET 请求且该请求已被允许，而文档的内容（自上次访问以来或者根据请求的条件）并没有改变，则服务器应当返回这个状态码。304响应禁止包含消息体，因此始终以消息头后的第一个空行结尾。<br>该响应必须包含以下的头信息：<br>Date，除非这个服务器没有时钟。假如没有时钟的服务器也遵守这些规则，那么代理服务器以及客户端可以自行将 Date 字段添加到接收到的响应头中去（正如RFC 2068中规定的一样），缓存机制将会正常工作。<br>ETag 和/或 Content-Location，假如同样的请求本应返回200响应。<br>Expires, Cache-Control，和/或Vary，假如其值可能与之前相同变量的其他响应对应的值不同的话。<br>假如本响应请求使用了强缓存验证，那么本次响应不应该包含其他实体头；否则（例如，某个带条件的 GET 请求使用了弱缓存验证），本次响应禁止包含其他实体头；这避免了缓存了的实体内容和更新了的实体头信息之间的不一致。<br>假如某个304响应指明了当前某个实体没有缓存，那么缓存系统必须忽视这个响应，并且重复发送不包含限制条件的请求。<br>假如接收到一个要求更新某个缓存条目的304响应，那么缓存系统必须更新整个条目以反映所有在响应中被更新的字段的值。</p><h2 id="305-Use-Proxy"><a href="#305-Use-Proxy" class="headerlink" title="305 Use Proxy"></a>305 Use Proxy</h2><p>被请求的资源必须通过指定的代理才能被访问。Location 域中将给出指定的代理所在的 URI 信息，接收者需要重复发送一个单独的请求，通过这个代理才能访问相应资源。只有原始服务器才能建立305响应。<br>注意：RFC 2068中没有明确305响应是为了重定向一个单独的请求，而且只能被原始服务器建立。忽视这些限制可能导致严重的安全后果。</p><h2 id="306-Switch-Proxy"><a href="#306-Switch-Proxy" class="headerlink" title="306 Switch Proxy"></a>306 Switch Proxy</h2><p>在最新版的规范中，306状态码已经不再被使用。</p><h2 id="307-Temporary-Redirect"><a href="#307-Temporary-Redirect" class="headerlink" title="307 Temporary Redirect"></a>307 Temporary Redirect</h2><p>请求的资源临时从不同的URI 响应请求。<br>新的临时性的URI 应当在响应的 Location 域中返回。除非这是一个HEAD 请求，否则响应的实体中应当包含指向新的URI 的超链接及简短说明。因为部分浏览器不能识别307响应，因此需要添加上述必要信息以便用户能够理解并向新的 URI 发出访问请求。<br>如果这不是一个GET 或者 HEAD 请求，那么浏览器禁止自动进行重定向，除非得到用户的确认，因为请求的条件可能因此发生变化。</p><h1 id="请求错误"><a href="#请求错误" class="headerlink" title="请求错误"></a>请求错误</h1><ul><li>这类的状态码代表了客户端看起来可能发生了错误，妨碍了服务器的处理。除非响应的是一个 HEAD 请求，否则服务器就应该返回一个解释当前错误状况的实体，以及这是临时的还是永久性的状况。这些状态码适用于任何请求方法。浏览器应当向用户显示任何包含在此类错误响应中的实体内容。<br>如果错误发生时客户端正在传送数据，那么使用TCP的服务器实现应当仔细确保在关闭客户端与服务器之间的连接之前，客户端已经收到了包含错误信息的数据包。如果客户端在收到错误信息后继续向服务器发送数据，服务器的TCP栈将向客户端发送一个重置数据包，以清除该客户端所有还未识别的输入缓冲，以免这些数据被服务器上的应用程序读取并干扰后者。</li></ul><h2 id="400-Bad-Request"><a href="#400-Bad-Request" class="headerlink" title="400 Bad Request"></a>400 Bad Request</h2><p>1、语义有误，当前请求无法被服务器理解。除非进行修改，否则客户端不应该重复提交这个请求。<br>2、请求参数有误。</p><h2 id="401-Unauthorized"><a href="#401-Unauthorized" class="headerlink" title="401 Unauthorized"></a>401 Unauthorized</h2><p>当前请求需要用户验证。该响应必须包含一个适用于被请求资源的 WWW-Authenticate 信息头用以询问用户信息。客户端可以重复提交一个包含恰当的 Authorization 头信息的请求。如果当前请求已经包含了 Authorization 证书，那么401响应代表着服务器验证已经拒绝了那些证书。如果401响应包含了与前一个响应相同的身份验证询问，且浏览器已经至少尝试了一次验证，那么浏览器应当向用户展示响应中包含的实体信息，因为这个实体信息中可能包含了相关诊断信息。参见RFC 2617。</p><h2 id="402-Payment-Required"><a href="#402-Payment-Required" class="headerlink" title="402 Payment Required"></a>402 Payment Required</h2><p>该状态码是为了将来可能的需求而预留的。</p><h2 id="403-Forbidden"><a href="#403-Forbidden" class="headerlink" title="403 Forbidden"></a>403 Forbidden</h2><p>服务器已经理解请求，但是拒绝执行它。与401响应不同的是，身份验证并不能提供任何帮助，而且这个请求也不应该被重复提交。如果这不是一个 HEAD 请求，而且服务器希望能够讲清楚为何请求不能被执行，那么就应该在实体内描述拒绝的原因。当然服务器也可以返回一个404响应，假如它不希望让客户端获得任何信息。</p><h2 id="404-Not-Found"><a href="#404-Not-Found" class="headerlink" title="404 Not Found"></a>404 Not Found</h2><p>请求失败，请求所希望得到的资源未被在服务器上发现。没有信息能够告诉用户这个状况到底是暂时的还是永久的。假如服务器知道情况的话，应当使用410状态码来告知旧资源因为某些内部的配置机制问题，已经永久的不可用，而且没有任何可以跳转的地址。404这个状态码被广泛应用于当服务器不想揭示到底为何请求被拒绝或者没有其他适合的响应可用的情况下。出现这个错误的最有可能的原因是服务器端没有这个页面。</p><h2 id="405-Method-Not-Allowed"><a href="#405-Method-Not-Allowed" class="headerlink" title="405 Method Not Allowed"></a>405 Method Not Allowed</h2><p>请求行中指定的请求方法不能被用于请求相应的资源。该响应必须返回一个Allow 头信息用以表示出当前资源能够接受的请求方法的列表。<br>鉴于 PUT，DELETE 方法会对服务器上的资源进行写操作，因而绝大部分的网页服务器都不支持或者在默认配置下不允许上述请求方法，对于此类请求均会返回405错误。</p><h2 id="406-Not-Acceptable"><a href="#406-Not-Acceptable" class="headerlink" title="406 Not Acceptable"></a>406 Not Acceptable</h2><p>请求的资源的内容特性无法满足请求头中的条件，因而无法生成响应实体。<br>除非这是一个 HEAD 请求，否则该响应就应当返回一个包含可以让用户或者浏览器从中选择最合适的实体特性以及地址列表的实体。实体的格式由 Content-Type 头中定义的媒体类型决定。浏览器可以根据格式及自身能力自行作出最佳选择。但是，规范中并没有定义任何作出此类自动选择的标准。</p><h2 id="407-Proxy-Authentication-Required"><a href="#407-Proxy-Authentication-Required" class="headerlink" title="407 Proxy Authentication Required"></a>407 Proxy Authentication Required</h2><p>与401响应类似，只不过客户端必须在代理服务器上进行身份验证。代理服务器必须返回一个 Proxy-Authenticate 用以进行身份询问。客户端可以返回一个 Proxy-Authorization 信息头用以验证。参见RFC 2617。</p><h2 id="408-Request-Timeout"><a href="#408-Request-Timeout" class="headerlink" title="408 Request Timeout"></a>408 Request Timeout</h2><p>请求超时。客户端没有在服务器预备等待的时间内完成一个请求的发送。客户端可以随时再次提交这一请求而无需进行任何更改。</p><h2 id="409-Conflict"><a href="#409-Conflict" class="headerlink" title="409 Conflict"></a>409 Conflict</h2><p>由于和被请求的资源的当前状态之间存在冲突，请求无法完成。这个代码只允许用在这样的情况下才能被使用：用户被认为能够解决冲突，并且会重新提交新的请求。该响应应当包含足够的信息以便用户发现冲突的源头。<br>冲突通常发生于对 PUT 请求的处理中。例如，在采用版本检查的环境下，某次 PUT 提交的对特定资源的修改请求所附带的版本信息与之前的某个（第三方）请求向冲突，那么此时服务器就应该返回一个409错误，告知用户请求无法完成。此时，响应实体中很可能会包含两个冲突版本之间的差异比较，以便用户重新提交归并以后的新版本。</p><h2 id="410-Gone"><a href="#410-Gone" class="headerlink" title="410 Gone"></a>410 Gone</h2><p>被请求的资源在服务器上已经不再可用，而且没有任何已知的转发地址。这样的状况应当被认为是永久性的。如果可能，拥有链接编辑功能的客户端应当在获得用户许可后删除所有指向这个地址的引用。如果服务器不知道或者无法确定这个状况是否是永久的，那么就应该使用404状态码。除非额外说明，否则这个响应是可缓存的。<br>410响应的目的主要是帮助网站管理员维护网站，通知用户该资源已经不再可用，并且服务器拥有者希望所有指向这个资源的远端连接也被删除。这类事件在限时、增值服务中很普遍。同样，410响应也被用于通知客户端在当前服务器站点上，原本属于某个个人的资源已经不再可用。当然，是否需要把所有永久不可用的资源标记为’410 Gone’，以及是否需要保持此标记多长时间，完全取决于服务器拥有者。</p><h2 id="411-Length-Required"><a href="#411-Length-Required" class="headerlink" title="411 Length Required"></a>411 Length Required</h2><p>服务器拒绝在没有定义 Content-Length 头的情况下接受请求。在添加了表明请求消息体长度的有效 Content-Length 头之后，客户端可以再次提交该请求。</p><h2 id="412-Precondition-Failed"><a href="#412-Precondition-Failed" class="headerlink" title="412 Precondition Failed"></a>412 Precondition Failed</h2><p>服务器在验证在请求的头字段中给出先决条件时，没能满足其中的一个或多个。这个状态码允许客户端在获取资源时在请求的元信息（请求头字段数据）中设置先决条件，以此避免该请求方法被应用到其希望的内容以外的资源上。</p><h2 id="413-Request-Entity-Too-Large"><a href="#413-Request-Entity-Too-Large" class="headerlink" title="413 Request Entity Too Large"></a>413 Request Entity Too Large</h2><p>服务器拒绝处理当前请求，因为该请求提交的实体数据大小超过了服务器愿意或者能够处理的范围。此种情况下，服务器可以关闭连接以免客户端继续发送此请求。<br>如果这个状况是临时的，服务器应当返回一个 Retry-After 的响应头，以告知客户端可以在多少时间以后重新尝试。</p><h2 id="414-Request-URI-Too-Long"><a href="#414-Request-URI-Too-Long" class="headerlink" title="414 Request-URI Too Long"></a>414 Request-URI Too Long</h2><p>请求的URI 长度超过了服务器能够解释的长度，因此服务器拒绝对该请求提供服务。这比较少见，通常的情况包括：<br>本应使用POST方法的表单提交变成了GET方法，导致查询字符串（Query String）过长。<br>重定向URI “黑洞”，例如每次重定向把旧的 URI 作为新的 URI 的一部分，导致在若干次重定向后 URI 超长。<br>客户端正在尝试利用某些服务器中存在的安全漏洞攻击服务器。这类服务器使用固定长度的缓冲读取或操作请求的 URI，当 GET 后的参数超过某个数值后，可能会产生缓冲区溢出，导致任意代码被执行[1]。没有此类漏洞的服务器，应当返回414状态码。</p><h2 id="415-Unsupported-Media-Type"><a href="#415-Unsupported-Media-Type" class="headerlink" title="415 Unsupported Media Type"></a>415 Unsupported Media Type</h2><p>对于当前请求的方法和所请求的资源，请求中提交的实体并不是服务器中所支持的格式，因此请求被拒绝。</p><h2 id="416-Requested-Range-Not-Satisfiable"><a href="#416-Requested-Range-Not-Satisfiable" class="headerlink" title="416 Requested Range Not Satisfiable"></a>416 Requested Range Not Satisfiable</h2><p>如果请求中包含了 Range 请求头，并且 Range 中指定的任何数据范围都与当前资源的可用范围不重合，同时请求中又没有定义 If-Range 请求头，那么服务器就应当返回416状态码。<br>假如 Range 使用的是字节范围，那么这种情况就是指请求指定的所有数据范围的首字节位置都超过了当前资源的长度。服务器也应当在返回416状态码的同时，包含一个 Content-Range 实体头，用以指明当前资源的长度。这个响应也被禁止使用 multipart/byteranges 作为其 Content-Type。</p><h2 id="417-Expectation-Failed"><a href="#417-Expectation-Failed" class="headerlink" title="417 Expectation Failed"></a>417 Expectation Failed</h2><p>在请求头 Expect 中指定的预期内容无法被服务器满足，或者这个服务器是一个代理服务器，它有明显的证据证明在当前路由的下一个节点上，Expect 的内容无法被满足。</p><h2 id="418-I’m-a-teapot"><a href="#418-I’m-a-teapot" class="headerlink" title="418 I’m a teapot"></a>418 I’m a teapot</h2><h2 id="421-Misdirected-Request"><a href="#421-Misdirected-Request" class="headerlink" title="421 Misdirected Request"></a>421 Misdirected Request</h2><p>请求被指向到无法生成响应的服务器（比如由于连接重复使用）</p><h2 id="422-Unprocessable-Entity"><a href="#422-Unprocessable-Entity" class="headerlink" title="422 Unprocessable Entity"></a>422 Unprocessable Entity</h2><p>请求格式正确，但是由于含有语义错误，无法响应。（RFC 4918 WebDAV）</p><h2 id="423-Locked"><a href="#423-Locked" class="headerlink" title="423 Locked"></a>423 Locked</h2><p>当前资源被锁定。（RFC 4918 WebDAV）</p><h2 id="424-Failed-Dependency"><a href="#424-Failed-Dependency" class="headerlink" title="424 Failed Dependency"></a>424 Failed Dependency</h2><p>由于之前的某个请求发生的错误，导致当前请求失败，例如 PROPPATCH。（RFC 4918 WebDAV）</p><h2 id="425-Too-Early"><a href="#425-Too-Early" class="headerlink" title="425 Too Early"></a>425 Too Early</h2><p>状态码 425 Too Early 代表服务器不愿意冒风险来处理该请求，原因是处理该请求可能会被“重放”，从而造成潜在的重放攻击。（RFC 8470） [1]  </p><h2 id="426-Upgrade-Required"><a href="#426-Upgrade-Required" class="headerlink" title="426 Upgrade Required"></a>426 Upgrade Required</h2><p>客户端应当切换到TLS/1.0。（RFC 2817）</p><h2 id="449-Retry-With"><a href="#449-Retry-With" class="headerlink" title="449 Retry With"></a>449 Retry With</h2><p>由微软扩展，代表请求应当在执行完适当的操作后进行重试。</p><h2 id="451-Unavailable-For-Legal-Reasons"><a href="#451-Unavailable-For-Legal-Reasons" class="headerlink" title="451 Unavailable For Legal Reasons"></a>451 Unavailable For Legal Reasons</h2><p>该请求因法律原因不可用。（RFC 7725）</p><h1 id="服务器错误"><a href="#服务器错误" class="headerlink" title="服务器错误"></a>服务器错误</h1><ul><li>（5、6字头）<br>这类状态码代表了服务器在处理请求的过程中有错误或者异常状态发生，也有可能是服务器意识到以当前的软硬件资源无法完成对请求的处理。除非这是一个HEAD 请求，否则服务器应当包含一个解释当前错误状态以及这个状况是临时的还是永久的解释信息实体。浏览器应当向用户展示任何在当前响应中被包含的实体。<br>这些状态码适用于任何响应方法。</li></ul><h2 id="500-Internal-Server-Error"><a href="#500-Internal-Server-Error" class="headerlink" title="500 Internal Server Error"></a>500 Internal Server Error</h2><p>服务器遇到了一个未曾预料的状况，导致了它无法完成对请求的处理。一般来说，这个问题都会在服务器端的源代码出现错误时出现。</p><h2 id="501-Not-Implemented"><a href="#501-Not-Implemented" class="headerlink" title="501 Not Implemented"></a>501 Not Implemented</h2><p>服务器不支持当前请求所需要的某个功能。当服务器无法识别请求的方法，并且无法支持其对任何资源的请求。</p><h2 id="502-Bad-Gateway"><a href="#502-Bad-Gateway" class="headerlink" title="502 Bad Gateway"></a>502 Bad Gateway</h2><p>作为网关或者代理工作的服务器尝试执行请求时，从上游服务器接收到无效的响应。</p><h2 id="503-Service-Unavailable"><a href="#503-Service-Unavailable" class="headerlink" title="503 Service Unavailable"></a>503 Service Unavailable</h2><p>由于临时的服务器维护或者过载，服务器当前无法处理请求。这个状况是临时的，并且将在一段时间以后恢复。如果能够预计延迟时间，那么响应中可以包含一个 Retry-After 头用以标明这个延迟时间。如果没有给出这个 Retry-After 信息，那么客户端应当以处理500响应的方式处理它。<br>注意：503状态码的存在并不意味着服务器在过载的时候必须使用它。某些服务器只不过是希望拒绝客户端的连接。</p><h2 id="504-Gateway-Timeout"><a href="#504-Gateway-Timeout" class="headerlink" title="504 Gateway Timeout"></a>504 Gateway Timeout</h2><p>作为网关或者代理工作的服务器尝试执行请求时，未能及时从上游服务器（URI标识出的服务器，例如HTTP、FTP、LDAP）或者辅助服务器（例如DNS）收到响应。<br>注意：某些代理服务器在DNS查询超时时会返回400或者500错误</p><h2 id="505-HTTP-Version-Not-Supported"><a href="#505-HTTP-Version-Not-Supported" class="headerlink" title="505 HTTP Version Not Supported"></a>505 HTTP Version Not Supported</h2><p>服务器不支持，或者拒绝支持在请求中使用的 HTTP 版本。这暗示着服务器不能或不愿使用与客户端相同的版本。响应中应当包含一个描述了为何版本不被支持以及服务器支持哪些协议的实体。</p><h2 id="506-Variant-Also-Negotiates"><a href="#506-Variant-Also-Negotiates" class="headerlink" title="506 Variant Also Negotiates"></a>506 Variant Also Negotiates</h2><p>由《透明内容协商协议》（RFC 2295）扩展，代表服务器存在内部配置错误：被请求的协商变元资源被配置为在透明内容协商中使用自己，因此在一个协商处理中不是一个合适的重点。</p><h2 id="507-Insufficient-Storage"><a href="#507-Insufficient-Storage" class="headerlink" title="507 Insufficient Storage"></a>507 Insufficient Storage</h2><p>服务器无法存储完成请求所必须的内容。这个状况被认为是临时的。WebDAV (RFC 4918)</p><h2 id="509-Bandwidth-Limit-Exceeded"><a href="#509-Bandwidth-Limit-Exceeded" class="headerlink" title="509 Bandwidth Limit Exceeded"></a>509 Bandwidth Limit Exceeded</h2><p>服务器达到带宽限制。这不是一个官方的状态码，但是仍被广泛使用。</p><h2 id="510-Not-Extended"><a href="#510-Not-Extended" class="headerlink" title="510 Not Extended"></a>510 Not Extended</h2><p>获取资源所需要的策略并没有被满足。（RFC 2774）</p><h2 id="600-Unparseable-Response-Headers"><a href="#600-Unparseable-Response-Headers" class="headerlink" title="600 Unparseable Response Headers"></a>600 Unparseable Response Headers</h2><p>源站没有返回响应头部，只返回实体内容。 </p><p>来源：<a href="https://baike.baidu.com/item/HTTP状态码/5053660?fr=aladdin" target="_blank" rel="noopener">百度百科</a></p>]]></content>
      
      
      <categories>
          
          <category> HTTP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTTP状态码 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JSTL标签不起作用</title>
      <link href="/posts/jstl/"/>
      <url>/posts/jstl/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\css\APlayer.min.css"><script src="\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\js\Meting.min.js"></script><h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><ul><li>JSP页面中的EL标签直接成字符串输出(如:${msg})</li></ul><h2 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h2><p>el标签没有被识别，有以下两种可能</p><ol><li>jdk+jstl的组合不匹配</li><li>web.xml版本不匹配</li></ol><h2 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h2><ul><li>jsp页面的开头加一句<br><code>&lt;%@ page isELIgnored=“false” %&gt;</code>再测试,完美解决。</li></ul>]]></content>
      
      
      <categories>
          
          <category> EL&amp;JSTL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 问题集 </tag>
            
            <tag> JSTL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring</title>
      <link href="/posts/Spring/"/>
      <url>/posts/Spring/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\css\APlayer.min.css"><script src="\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\js\Meting.min.js"></script><h1 id="第1章-Spring概述"><a href="#第1章-Spring概述" class="headerlink" title="第1章 Spring概述"></a><center>第1章 Spring概述</center></h1><h2 id="sping简述"><a href="#sping简述" class="headerlink" title="sping简述"></a>sping简述</h2><ul><li><p>一个轻量级框架，核心技术是ioc，aop，针对接口编程，实现解耦合。</p></li><li><p>一个容器，储存java对象的容器，需要做的是把对象放入到容器中</p></li><li><p>方便集成各种优秀框架</p><blockquote><p>Spring 不排斥各种优秀的开源框架，相反 Spring 可以降低各种框架的使用难度，Spring提供了对各种优秀框架（如 Struts,Hibernate、MyBatis）等的直接支持。简化框架的使用。Spring 像插线板一样，其他框架是插头，可以容易的组合到一起。需要使用哪个框架，就把这个插头放入插线板。不需要可以轻易的移除。</p></blockquote></li><li><p><a href="https://spring.io/" target="_blank" rel="noopener">spring官网</a> ，<a href="https://www.docs4dev.com/docs/zh/spring-framework/4.3.21.RELEASE/reference" target="_blank" rel="noopener">spring中文文档</a></p></li></ul><h2 id="怎么使用spring"><a href="#怎么使用spring" class="headerlink" title="怎么使用spring"></a>怎么使用spring</h2><ol><li>spring是一个容器，把项目中用的对象放入到容器中</li><li>让容器完成对象的创建，对象之间关系的管理（属性赋值）</li><li>我们在程序中从容器中获取 要使用的对象</li></ol><h2 id="不放入到spring容器中的对象"><a href="#不放入到spring容器中的对象" class="headerlink" title="不放入到spring容器中的对象"></a>不放入到spring容器中的对象</h2><ol><li>实体类对象，实体类数据来自数据库的</li><li>servlet， listener， filter等由Tomcat管理的</li></ol><h2 id="什么样的对象放入容器中"><a href="#什么样的对象放入容器中" class="headerlink" title="什么样的对象放入容器中"></a>什么样的对象放入容器中</h2><ul><li>dao类，service类，controller类，工具类<ol><li>xml配置文件，使用<code>&lt;bean&gt;</code></li><li>注解</li></ol></li><li>spring中的对象默认都是单例的，在容器中叫这个名称的对象只有一个</li></ul><h2 id="使用spring框架的步骤"><a href="#使用spring框架的步骤" class="headerlink" title="使用spring框架的步骤"></a>使用spring框架的步骤</h2><ol><li><p>加入依赖</p> <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.5.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>创建类：接口，实现类，没有接口的类</p> <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">SomeService</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">doSome</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SomeServiceImpl</span>  <span class="keyword">implements</span> <span class="title">SomeService</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSome</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"SomeServiceImpl 启动"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>创建spring的配置文件，使用<bean>声明对象</p> <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--xsd 是约束文件的扩展名  xsd 的约束文件功能强，验证比较全面--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--声明java对象交给Spring创建和管理</span></span><br><span class="line"><span class="comment">          class：类的全限定名称，不能是接口（Spring使用反射创建对象）</span></span><br><span class="line"><span class="comment">          id：自定义的对象名称，要求是唯一值。表示在Spring中的对象名称，</span></span><br><span class="line"><span class="comment">              通过这个名称可以从Spring中找到对象。获取对象</span></span><br><span class="line"><span class="comment">           对象是放入到Spring的容器（Map&lt;id,对象&gt;）</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"someService"</span> <span class="attr">class</span>=<span class="string">"com.test.service.SomeServiceImpl"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--&lt;bean&gt;等同于SomeService someService = new SomServiceImpl();--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>我们使用容器中的对象，通过ApplicationContext接口和他的实现类ClassPathXmlApplcactionContext的方法getBean()</p> <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"> <span class="meta">@Test</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">     System.out.println( <span class="string">"Hello World!"</span> );</span><br><span class="line">     <span class="comment">//定义Spring的配置文件</span></span><br><span class="line">     String config=<span class="string">"applicationContext.xml"</span>;</span><br><span class="line"></span><br><span class="line">     <span class="comment">//创建Spring的容器对象，根据Spring配置文件的位置，使用接口的不同实现类</span></span><br><span class="line">     <span class="comment">//如果Spring配置文件位置是在类路径下（classpath）</span></span><br><span class="line">     ApplicationContext ctx= <span class="keyword">new</span> ClassPathXmlApplicationContext(config);</span><br><span class="line"><span class="comment">//根目录下    ApplicationContext ctx = new FileSystemXmlApplicationContext(config);</span></span><br><span class="line"></span><br><span class="line">     <span class="comment">//创建容器对象时，就把配置文件的所有对象都创建出来，放到容器中，需要时再取出来</span></span><br><span class="line">     SomeService service= (SomeService) ctx.getBean(<span class="string">"someService"</span>);</span><br><span class="line">     <span class="comment">//调用业务的方法</span></span><br><span class="line">     service.doSome();</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></li></ol><h1 id="第2章-IOC-控制反转"><a href="#第2章-IOC-控制反转" class="headerlink" title="第2章 IOC 控制反转"></a><center>第2章 IOC 控制反转</center></h1><blockquote><p>控制反转（IoC，Inversion of Control），是一个概念，是一种思想。指将传统上由程序代码直接操控的对象调用权交给容器，通过容器来实现对象的装配和管理。控制反转就是对对象控制权的转移，从程序代码本身反转到了外部容器。通过容器实现对象的创建，属性赋值，依赖的管理。</p></blockquote><ul><li><p><strong>描述</strong>：把对象的创建，赋值，管理工作都交给代码之外的容器实现，也就是对象的创建是有其它外部资源完成</p></li><li><p><strong>控制</strong>： 创建对象，对象的属性赋值，对象之间的关系管理。</p></li><li><p><strong>反转</strong>： 把原来的开发人员管理，创建对象的权限转移给代码之外的容器实现。 由容器代替开发人员管理对象。创建对象，给属性赋值。</p></li><li><p><strong>正转</strong>：由开发人员在代码中，使用new 构造方法创建对象， 开发人员主动管理对象。</p><pre><code>public static void main(String args[]){    Student student = new Student(); // 在代码中， 创建对象。--正转。 }</code></pre></li></ul><h2 id="ioc技术实现使用的DI（依赖注入）"><a href="#ioc技术实现使用的DI（依赖注入）" class="headerlink" title="ioc技术实现使用的DI（依赖注入）"></a>ioc技术实现使用的DI（依赖注入）</h2><ul><li>Spring 容器是一个超级大工厂，负责创建、管理所有的 Java 对象，这些 Java 对象被称为 Bean。Spring 容器管理着容器中 Bean 之间的依赖关系，Spring 使用“依赖注入”的方式来管理 Bean 之间的依赖关系。使用 IoC 实现对象之间的解耦和。<br>  <strong>开发人员在项目中只需要提供对象的名称， 对象的创建，查找，赋值都由容器内部自己实现</strong><br>  <strong>(spring使用di的技术， 底层使用的是反射机制)</strong></li></ul><ul><li>为什么要使用 ioc ： <code>目的就是减少对代码的改动， 也能实现不同的功能。 实现解耦合</code></li></ul><h2 id="基于xml的DI"><a href="#基于xml的DI" class="headerlink" title="基于xml的DI"></a>基于xml的DI</h2><h3 id="set注入"><a href="#set注入" class="headerlink" title="set注入"></a>set注入</h3><ul><li>spring调用类的set方法实现属性赋值</li></ul><ol><li>简单类型的set注入<property name="属性名" value="属性的值" /> <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"student"</span> <span class="attr">class</span>=<span class="string">"com.text.pack01.Student"</span> &gt;</span></span><br><span class="line">    <span class="comment">&lt;!--通过set方法注入--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"lisi"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"age"</span>  <span class="attr">value</span>=<span class="string">"20"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li>引用类型的set注入<proper name="属性名" ref="bean的id" /> <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"school"</span> <span class="attr">ref</span>=<span class="string">"school"</span>/&gt;</span></span><br></pre></td></tr></table></figure></li></ol><h3 id="构造注入"><a href="#构造注入" class="headerlink" title="构造注入"></a>构造注入</h3><ul><li>spring调用有参数构造方法</li></ul><ol><li><code>&lt;constructor-arg&gt;</code>的name属性，name表示构造方法的形参名</li><li><code>&lt;constructor-arg&gt;</code>的index属性，表示构造方法形参的位置，从0开始</li></ol><h3 id="自动注入"><a href="#自动注入" class="headerlink" title="自动注入"></a>自动注入</h3><ol><li>byName: 按名称注入， java类中引用类型的<strong>【属性名】</strong>和spring容器中bean的<strong>【id】</strong>一样，数据类型一样。这样的bean赋值给引用类型<br> <code>&lt;bean id=&quot;student&quot; class=&quot;com.text.pack01.Student&quot; autowire=&quot;byName&quot;&gt;</code></li></ol><ol start="2"><li>byType：按类型注入，java类中引用类型的是<strong>【数据类型】</strong>和spring容器中bean的<strong>【class】</strong>是同源关系的，这样的bean能够赋值给引用类型</li></ol><h2 id="基于注解的DI"><a href="#基于注解的DI" class="headerlink" title="基于注解的DI"></a>基于注解的DI</h2><h3 id="常用注解"><a href="#常用注解" class="headerlink" title="常用注解"></a>常用注解</h3><ol><li><strong>@Component</strong> 创建对象</li><li><strong>@Repository</strong> 创建dao对象，用来访问数据库的</li><li><strong>@Service</strong> 创建Service对象， 处理业务逻辑的，可以有事务功能</li><li><strong>@Controller</strong> 创建控制器对象的， 接收请求，显示处理结果的</li><li><strong>@Value</strong> 简单类型的属性赋值</li><li><strong>@Autowired</strong> spring框架中引用类型的赋值注解， 支持byName,byType,默认是byType</li><li><strong>@Resource</strong> jdk中的注解，spring框架提供了对这个注解的功能支持,使用自动注入给引用类型赋值，<br>支持byName，byType，默认是byName</li></ol><h3 id="注解的使用步骤："><a href="#注解的使用步骤：" class="headerlink" title="注解的使用步骤："></a>注解的使用步骤：</h3><ol><li>加入依赖 ：spring-context, 间接加入spring-aop</li><li>在类中加入注解 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//使用注解创建对象 默认类的第一个字母小写</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="comment">//可以在属性上，也可以在set方法上</span></span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"李四"</span>)</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"20"</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//@Resource  设置byType @Resource（name=byType）</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//@Autowired 默认byType  用byName加@Qualifier注解</span></span><br><span class="line">    <span class="comment">//@Autowired(required=true) 默认true 注入失败报错，required=false 注入失败值为null。</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="meta">@Qualifier</span>(<span class="string">"mySchool"</span>)<span class="comment">//设置byName</span></span><br><span class="line">    <span class="keyword">private</span> School school;</span><br><span class="line">......</span><br></pre></td></tr></table></figure></li><li>在spring的配置文件中，加入组件扫描器的标签 &lt;context:component-scan base-package=”包名”&gt;</li></ol><h2 id="ioc能实现解耦合"><a href="#ioc能实现解耦合" class="headerlink" title="ioc能实现解耦合"></a>ioc能实现解耦合</h2><blockquote><p>ioc能够实现业务对象之间的解耦合， 例如service和dao对象之间的解耦合。</p></blockquote><h1 id="第3章-AOP-面向切面编程"><a href="#第3章-AOP-面向切面编程" class="headerlink" title="第3章 AOP 面向切面编程"></a><center>第3章 AOP 面向切面编程</center></h1><h2 id="动态代理"><a href="#动态代理" class="headerlink" title="动态代理"></a>动态代理</h2><blockquote><p><a href="https://www.jianshu.com/p/9cdcf4e5c27d" target="_blank" rel="noopener">动态代理是指</a>， 程序在整个运行过程中根本就不存在目标类的代理类，目标对象的代理<br>对象只是由代理生成工具（不是真实定义的类）在程序运行时由 JVM 根据反射等机制动态<br>生成的。代理对象与目标对象的代理关系在程序运行时才确立。</p></blockquote><h3 id="jdk动态代理"><a href="#jdk动态代理" class="headerlink" title="jdk动态代理"></a>jdk动态代理</h3><p>使用jdk反射包中的类实现创建代理对象的功能<br>要求：目标类必须实现接口<br>    <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DaiLi</span> <span class="keyword">implements</span> <span class="title">InvocationHandler</span> </span>&#123;</span><br><span class="line"><span class="comment">//目标对象</span></span><br><span class="line">    <span class="keyword">private</span> Object target;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DaiLi</span><span class="params">(Object target)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.target = target;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//代理类的业务方法</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        SqlSession session=<span class="keyword">null</span>;</span><br><span class="line">        Object obj=<span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            session= SqlSessionUtil.getSession();</span><br><span class="line">            <span class="comment">//处理业务逻辑</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">//真实对象的业务方法</span></span><br><span class="line">            obj=method.invoke(target,args);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//处理业务逻辑完毕</span></span><br><span class="line">            session.commit();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">//异常回滚</span></span><br><span class="line">            session.rollback();</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            SqlSessionUtil.closeSession(session);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取代理对象</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getProxy</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Proxy.newProxyInstance(target.getClass().getClassLoader(),target.getClass().getInterfaces(),<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="cglib动态代理"><a href="#cglib动态代理" class="headerlink" title="cglib动态代理"></a>cglib动态代理</h3><p>使用第三方的工具库，实现代理对象的创建<br>要求：目标类必须能够继承，不能是final<br>原理：就是继承，子类就是代理</p><h3 id="动态代理作用"><a href="#动态代理作用" class="headerlink" title="动态代理作用"></a>动态代理作用</h3><ol><li>在目标类不修改源代码的情况下，增加功能</li><li>减少重复的代码</li><li>专注业务功能的实现</li><li>解耦合： 业务功能和日志，事务这些非业务功能的耦合</li></ol><h2 id="AOP概述"><a href="#AOP概述" class="headerlink" title="AOP概述"></a>AOP概述</h2><ul><li>面向切面编程， 基于动态代理的，可以使用jdk，cglib两种代理方式。<br>Aop就是动态代理的规范化， 把动态代理的实现步骤，方式都定义好了，<br>让开发人员用一种统一的方式，使用动态代理。</li><li>怎么理解面向切面编程 ？<br>1)需要在分析项目功能时，找出切面。<br>2)合理的安排切面的执行时间（在目标方法前， 还是目标方法后）<br>3)合理的安全切面执行的位置，在哪个类，哪个方法增加增强功能</li></ul><h2 id="AOP-编程术语-掌握"><a href="#AOP-编程术语-掌握" class="headerlink" title="AOP 编程术语(掌握)"></a>AOP 编程术语(掌握)</h2><ol><li>aspect：切面，表示给业务方法增加的功能，一般日志输出，事务，权限检查等是切面</li><li>JoinPoint：连接点，连接点指可以被切面织入的具体方法。通常业务接口中的方法均为连接点。</li><li>pointcut:切入点，是一个或多个JoinPoint的集合，表示切面功能执行的位置</li><li>Target：目标对象，目标对象指将要被增强的对象 ，即包含主业务逻辑的类的对象 。</li><li>advice：通知，也叫增强，表示切面执行的时间，在方法前，方法后等等</li></ol><h2 id="什么时候考虑使用AOP技术"><a href="#什么时候考虑使用AOP技术" class="headerlink" title="什么时候考虑使用AOP技术"></a>什么时候考虑使用AOP技术</h2><ol><li>当你要给一个系统中存在的类修改功能，但是原有类的功能不完善，但是你还有源代码，使用aop就增加功能</li><li>你要给项目中的多个类，增加一个相同的功能，使用aop</li><li>给业务方法增加事务， 日志输出</li></ol><h2 id="AOP的实现框架"><a href="#AOP的实现框架" class="headerlink" title="AOP的实现框架"></a>AOP的实现框架</h2><ol><li>spring实现了aop， 实现方式是接口</li><li><a href="http://www.eclipse.org/aspectj/" target="_blank" rel="noopener">aspectj框架</a> （一个优秀面向切面的框架，它扩展了 Java 语言，提供了强大的切面实现。）<ol><li>使用注解可以实现aop的功能</li><li>使用xml配置文件中的标签实现aop功能</li></ol></li></ol><h2 id="aspectj框架的使用"><a href="#aspectj框架的使用" class="headerlink" title="aspectj框架的使用"></a>aspectj框架的使用</h2><h3 id="表示切面位置的切入点表达式"><a href="#表示切面位置的切入点表达式" class="headerlink" title="表示切面位置的切入点表达式"></a>表示切面位置的切入点表达式</h3><p>execution(访问修饰符 <code>返回值</code>  <code>包名.类名.方法名称(方法的参数)</code> 异常)<br><img src="/blog-img/Spring/aspectj.jpg" alt="切入点表达式"></p><h3 id="表示切面的执行时间，使用的通知注解"><a href="#表示切面的执行时间，使用的通知注解" class="headerlink" title="表示切面的执行时间，使用的通知注解"></a>表示切面的执行时间，使用的通知注解</h3><ol><li><p><strong>@Before 前置通知</strong> 在目标方法之前先执行切面的功能</p> <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Aspect</span><span class="comment">//定义切面类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Advice</span> </span>&#123;</span><br><span class="line">    <span class="comment">//增强功能的方法</span></span><br><span class="line">    <span class="meta">@Before</span>(value = <span class="string">"execution(public void com.test.service.pack01.OneServiceImpl.sayHi())"</span>)</span><br><span class="line">    <span class="comment">//属性value表示切面执行的位置</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Before</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"在目标方法执行之前，例如输出日志"</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>@AfterReturning 后置通知</strong> 在目标方法之后执行的，能够获取到目标方法的返回值</p> <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* returning是目标方法的返回值，命名与通知方法的形参名一致</span></span><br><span class="line"><span class="comment">        相当于 Object obj = sayHi(String,Integer)</span></span><br><span class="line"><span class="comment">          AfterReturning(obj)</span></span><br><span class="line"><span class="comment">        可以修改这个返回值，影响最后调用的结果</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">    <span class="meta">@AfterReturning</span>(value = <span class="string">"execution(* *..OneServiceImpl.sayHi(String,Integer))"</span>,returning = <span class="string">"obj"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">AfterReturning</span><span class="params">(JoinPoint jp,Object obj)</span></span>&#123;</span><br><span class="line">        <span class="comment">/*指定通知方法中的参数: JoinPoint</span></span><br><span class="line"><span class="comment">          JoinPoint（连接点）代表业务方法，要加入切面功能的业务方法 如sayHi</span></span><br><span class="line"><span class="comment">            作用是：可以在通知方法中获取方法执行时的信息，例如方法的名称，方法的实参。</span></span><br><span class="line"><span class="comment">            如果你的切面功能中需要用到方法的信息，就加入JoinPoint。</span></span><br><span class="line"><span class="comment">            这个JointPoint参数的值是由框架赋予，必须是第一个位置的参数</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        System.out.println("方法的签名（定义）="+jp.getSignature());</span></span><br><span class="line"><span class="comment">        System.out.println("方法的名称 ="+jp.getSignature().getName());</span></span><br><span class="line"><span class="comment">        //获取方法的实参</span></span><br><span class="line"><span class="comment">        Object args[] = jp.getArgs();</span></span><br><span class="line"><span class="comment">        for (Object arg:args</span></span><br><span class="line"><span class="comment">             ) &#123;</span></span><br><span class="line"><span class="comment">//可以用来判断目标方法的实参是否是想要的，然后再执行功能</span></span><br><span class="line"><span class="comment">            System.out.println("参数="+arg);</span></span><br><span class="line"><span class="comment">        &#125;*/</span></span><br><span class="line">        <span class="keyword">if</span>(obj!=<span class="keyword">null</span>)&#123;</span><br><span class="line">            System.out.println(<span class="string">"见面时间"</span>+<span class="keyword">new</span> Date());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>@Around 环绕通知</strong> 在目标方法前和后都能增强功能，控制目标方法的的访问，修改返回值</p> <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">       @Around: 环绕通知</span></span><br><span class="line"><span class="comment">         属性：value 切入点表达式</span></span><br><span class="line"><span class="comment">         位置；在方法的定义上面</span></span><br><span class="line"><span class="comment">        特点：</span></span><br><span class="line"><span class="comment">         1.它是功能最强的通知</span></span><br><span class="line"><span class="comment">         2.在目标方法的前和后都能增强功能</span></span><br><span class="line"><span class="comment">         3.控制目标方法是否被调用执行</span></span><br><span class="line"><span class="comment">         4.修改原来的目标方法的执行结果，影响最后调用的结果</span></span><br><span class="line"><span class="comment">  </span></span><br><span class="line"><span class="comment">        环绕通知等同与jdk动态代理的，InvocationHandler接口</span></span><br><span class="line"><span class="comment">           返回值就是目标方法的执行结果，可以被修改。</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="meta">@Around</span>(value = <span class="string">"execution(* *..OneServiceImpl.sayHi(String,Integer))"</span>)</span><br><span class="line">   <span class="function"><span class="keyword">public</span> Object <span class="title">Around</span><span class="params">(ProceedingJoinPoint pjp)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">       Object obj=<span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">       <span class="comment">//目标方法前加入功能</span></span><br><span class="line">       System.out.println(<span class="string">"见面时间"</span>+<span class="keyword">new</span> Date());</span><br><span class="line">       <span class="comment">//通过ProceedingJoinPoint.proceed对目标方法的调用</span></span><br><span class="line">       pjp.proceed();<span class="comment">//method.invoke();</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">//目标方法后加入功能</span></span><br><span class="line">       System.out.println(<span class="string">"提交事务"</span>);</span><br><span class="line">       <span class="keyword">return</span> obj;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>@AfterThrowing 异常通知</strong> 在目标方法抛出异常后执行的通知</p> <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//throwing属性 用于指定发生的异常对象</span></span><br><span class="line"><span class="comment">//相当于try&#123;目标方法&#125;catch()&#123; myAfterThrowing(Throwable ex) &#125;</span></span><br><span class="line"><span class="meta">@AfterThrowing</span>(value = <span class="string">"execution(* *..OneServiceImpl.sayHi(String,Integer))"</span>,throwing = <span class="string">"ex"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">myAfterThrowing</span><span class="params">(Throwable ex)</span></span>&#123;</span><br><span class="line">    <span class="comment">//记录异常信息</span></span><br><span class="line">    System.out.println(<span class="string">"异常通知：异常发生时执行"</span>+ex.getMessage());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>@After 最终通知</strong> 总是会被执行的代码</p> <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//相当于 try&#123;&#125;catch()&#123;&#125;finally&#123; myAfter() &#125;</span></span><br><span class="line"><span class="meta">@After</span>(value=<span class="string">"execution(* *..OneServiceImpl.sayHi(String,Integer))"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">myAfter</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"最终通知"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>@Pointcut</strong> 定义和管理切入点的辅助注解</p> <figure class="highlight java"><table><tr><td class="code"><pre><span class="line">  <span class="comment">/*@Pointcut : 定义和管理切入点，如果你的项目中有多个切入点表达式是重复的，可以复用的。</span></span><br><span class="line"><span class="comment">                    可以使用@Pointcut,统一管理切入点表达式。</span></span><br><span class="line"><span class="comment">       属性: value 切入点表达式</span></span><br><span class="line"><span class="comment">       位置: 在自定义的方法上面</span></span><br><span class="line"><span class="comment">      特点:</span></span><br><span class="line"><span class="comment">       当使用@Pointcut定义在一个方法的上面，此时这个方法就是切入点表达式的别名</span></span><br><span class="line"><span class="comment">       其他的通知中，value就可以使用这个方法代替切入点表达式。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Pointcut</span>(value = <span class="string">"execution(* *..OneServiceImpl.sayHi(String,Integer))"</span>)</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">pointCut</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//无需代码</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@After</span>(value=<span class="string">"pointCut()"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">myAfter</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"最终通知"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>代理的使用方式</p><ol><li>如果目标类有接口，框架使用jdk动态代理,得到service对象是com.sun.proxy.$Proxy10</li><li>如果目标类没有接口，默认使用的cglib动态代理,得到service对象是com.test.service.pack04.OneServiceImpl$$EnhancerBySpringCGLIB$$eb85df45</li><li>有接口也可以强制使用cglib动态代理<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    声明自动代理对象：使用aspectj框架的功能，创建目标对象的代理对象。</span></span><br><span class="line"><span class="comment">    创建代理对象时在内存中实现的，修改目标对象的内存中的机构。</span></span><br><span class="line"><span class="comment">    使用目标对象就是被修改后的代理对象</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:aspectj-autoproxy</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">如果你期望目标类有接口，但使用cglib代理</span></span><br><span class="line"><span class="comment">proxy-target-class="true" 告诉框架使用cglib动态代理</span></span><br><span class="line"><span class="comment">&lt;aop:aspectj-autoproxy proxy-target-class="true"/&gt;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure></li></ol></li><li><p>maven依赖</p> <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.11<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.5.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-aspects<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.5.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><h1 id="第4章-Spring集成Mybatis"><a href="#第4章-Spring集成Mybatis" class="headerlink" title="第4章 Spring集成Mybatis"></a><center>第4章 Spring集成Mybatis</center></h1><h2 id="整合的想法"><a href="#整合的想法" class="headerlink" title="整合的想法"></a>整合的想法</h2><p><strong>使用spring的ioc核心技术，把mybatis框架中使用的对象交给spring统一创建和管理。spring是容器，存放你项目中要使用的各种对象， 例如Service对象， Dao对象，工具类对象等等。</strong></p><h2 id="mybatis使用步骤"><a href="#mybatis使用步骤" class="headerlink" title="mybatis使用步骤"></a>mybatis使用步骤</h2><ol><li><p>定义dao接口 ，StudentDao,以及service接口和实现类</p> <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StudentDao</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">insertStudent</span><span class="params">(Student student)</span></span>;</span><br><span class="line">    <span class="function">List&lt;Student&gt; <span class="title">selectStudents</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//service.....</span></span><br></pre></td></tr></table></figure></li><li><p>定义mapper文件 StudentDao.xml</p> <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"cn.JInterest.dao.StudentDao"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"insertStudent"</span>&gt;</span></span><br><span class="line">        insert into student values(#&#123;id&#125;,#&#123;name&#125;,#&#123;email&#125;,#&#123;age&#125;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectStudents"</span> <span class="attr">resultType</span>=<span class="string">"Student"</span>&gt;</span></span><br><span class="line">        select id,name,email,age from student order by id desc</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>定义mybatis的主配置文件 mybatis.xml</p> <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--settings：控制mybatis全局行为--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--设置mybatis输出日志--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"logImpl"</span> <span class="attr">value</span>=<span class="string">"STDOUT_LOGGING"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--设置别名--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--name:实体类所在的包名</span></span><br><span class="line"><span class="comment">            表示cn.JInterest.domain包中的类名就是别名</span></span><br><span class="line"><span class="comment">            你可以使用Student表示cn.JInterest.domain.Student</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"cn.JInterest.domain"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- sql mapper(sql映射文件)的位置--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">          name：是包名， 这个包中的所有mapper.xml一次都能加载</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"cn.JInterest.dao"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>创建dao的代理对象<br><code>StudentDao dao = SqlSession.getMapper(StudentDao.class);</code><br><code>List&lt;Student&gt; students  = dao.selectStudents();</code></p></li><li><p>要使用dao对象，需要使用getMapper()方法，<br>怎么能使用getMapper()方法，需要哪些条件<br>1)获取SqlSession对象， 需要使用SqlSessionFactory的openSession()方法。<br>2)创建SqlSessionFactory对象。 通过读取mybatis的主配置文件，能创建SqlSessionFactory对象<br>使用Factory能获取SqlSession，有了SqlSession就能有dao ，目的就是获取dao对象，最后service层调用dao对象</p></li><li><p>spring整合mabatis后的applicationContext.xml文件<br>使用阿里公司的Druid连接池，配置文档：<a href="https://github.com/alibaba/druid/wiki/DruidDataSource配置" target="_blank" rel="noopener">DruidDataSource配置</a></p> <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">       https://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">       把数据库的配置信息，写在一个独立的文件，编译修改数据库的配置内容</span></span><br><span class="line"><span class="comment">       让spring知道jdbc.properties文件的位置</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">"classpath:jdbc.properties"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--声明数据源DataSource, 作用是连接数据库的,代替了mybatis的连接方式--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"myDataSource"</span> <span class="attr">class</span>=<span class="string">"com.alibaba.druid.pool.DruidDataSource"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">init-method</span>=<span class="string">"init"</span> <span class="attr">destroy-method</span>=<span class="string">"close"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--set注入给DruidDataSource提供连接数据库信息 --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">            使用属性配置文件中的数据，语法 $&#123;key&#125;</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.url&#125;"</span> /&gt;</span><span class="comment">&lt;!--setUrl()--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.username&#125;"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.passwd&#125;"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxActive"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.max&#125;"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--声明的是mybatis中提供的SqlSessionFactoryBean类，这个类内部创建SqlSessionFactory的--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--set注入，把数据库连接池付给了dataSource属性--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"myDataSource"</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--mybatis主配置文件的位置</span></span><br><span class="line"><span class="comment">           configLocation属性是Resource类型，读取配置文件</span></span><br><span class="line"><span class="comment">           它的赋值，使用value，指定文件的路径，使用classpath:表示文件的位置</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"configLocation"</span> <span class="attr">value</span>=<span class="string">"classpath:mybatis.xml"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        创建dao对象，使用SqlSession的getMapper（StudentDao.class）</span></span><br><span class="line"><span class="comment">        MapperScannerConfigurer:在内部调用getMapper()生成每个dao接口的代理对象 。</span></span><br><span class="line"><span class="comment">        org.apache.ibatis.binding.MapperProxy@9cd25ff</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--指定SqlSessionFactory对象的id--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sqlSessionFactoryBeanName"</span> <span class="attr">value</span>=<span class="string">"sqlSessionFactory"</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--指定包名， 包名是dao接口所在的包名。</span></span><br><span class="line"><span class="comment">            MapperScannerConfigurer会扫描这个包中的所有接口，把每个接口都执行</span></span><br><span class="line"><span class="comment">            一次getMapper()方法，得到每个接口的dao对象。</span></span><br><span class="line"><span class="comment">            创建好的dao对象放入到spring的容器中的。 dao对象的默认名称是 接口名首字母小写</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"basePackage"</span> <span class="attr">value</span>=<span class="string">"cn.JInterest.dao"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--声明service--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"studentService"</span> <span class="attr">class</span>=<span class="string">"cn.JInterest.service.impl.StudentServiceImpl"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"studentDao"</span> <span class="attr">ref</span>=<span class="string">"studentDao"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>pom.xml</p> <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.JInterest<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>Spring_04-mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>11<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>11<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--单元测试--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.11<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--spring核心ioc--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.5.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--做spring事务用到的--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-tx<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.5.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.5.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--mybatis依赖--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--mybatis和spring集成的依赖--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--mysql驱动--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.13<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--阿里公司的数据库连接池--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--目的是把src/main/java目录中的xml文件包含到输出结果中。输出到classes目录中--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/java<span class="tag">&lt;/<span class="name">directory</span>&gt;</span><span class="comment">&lt;!--所在的目录--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">includes</span>&gt;</span><span class="comment">&lt;!--包括目录下的.properties,.xml 文件都会扫描到--&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>false<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="交给spring的mybatis对象"><a href="#交给spring的mybatis对象" class="headerlink" title="交给spring的mybatis对象"></a>交给spring的mybatis对象</h2><ol><li>数据源DataSource,使用阿里公司的Druid连接池</li><li>SqlSessionFactory对象， 使用的SqlSessionFactoryBean在内部创建的SqlSessionFactory</li><li>Dao代理对象，使用的MapperScannConfigure，在这个类的内部，调用getMapper()，创建接口的Dao对象</li></ol><h1 id="第5章-Spring事务"><a href="#第5章-Spring事务" class="headerlink" title="第5章 Spring事务"></a><center>第5章 Spring事务</center></h1><h2 id="什么是事务"><a href="#什么是事务" class="headerlink" title="什么是事务"></a>什么是事务</h2><ul><li>讲mysql的时候，提出了事务。 事务是指一组sql语句的集合， 集合中有多条sql语句可能是insert ， update ，select ，delete，<br>我们希望这些多个sql语句都能成功，或者都失败， 这些sql语句的执行是一致的，作为一个整体执行。</li></ul><h2 id="在什么时候想到使用事务"><a href="#在什么时候想到使用事务" class="headerlink" title="在什么时候想到使用事务"></a>在什么时候想到使用事务</h2><ul><li>当我的操作，涉及得到多个表，或者是多个sql语句的insert，update，delete。需要保证这些语句都是成功才能完成我的功能，<br>或者都失败，保证操作是符合要求的。</li></ul><ul><li>在java代码中写程序，控制事务，此时事务应该放在那里呢？<br>service类的业务方法上，因为业务方法会调用多个dao方法，执行多个sql语句</li></ul><h2 id="通常怎么处理事务"><a href="#通常怎么处理事务" class="headerlink" title="通常怎么处理事务"></a>通常怎么处理事务</h2><ul><li>jdbc访问数据库，处理事务  Connection conn ; conn.commit(); conn.rollback();</li><li>mybatis访问数据库，处理事务， SqlSession.commit();  SqlSession.rollback();</li><li>hibernate访问数据库，处理事务， Session.commit(); Session.rollback();</li></ul><h2 id="问题中事务的处理方式，有什么不足"><a href="#问题中事务的处理方式，有什么不足" class="headerlink" title="问题中事务的处理方式，有什么不足"></a>问题中事务的处理方式，有什么不足</h2><ol><li>不同的数据库访问技术，处理事务的对象，方法不同，需要了解不同数据库访问技术使用事务的原理</li><li>掌握多种数据库中事务的处理逻辑。什么时候提交事务，什么时候回顾事务</li><li>处理事务的多种方法。</li></ol><ul><li>总结： 就是多种数据库的访问技术，有不同的事务处理的机制，对象，方法。</li></ul><h2 id="怎么解决不足"><a href="#怎么解决不足" class="headerlink" title="怎么解决不足"></a>怎么解决不足</h2><ul><li>spring提供一种处理事务的统一模型， 能使用统一步骤，方式完成多种不同数据库访问技术的事务处理。<br>使用spring的事务处理机制，可以完成<strong>mybatis</strong>访问数据库的事务处理<br>使用spring的事务处理机制，可以完成<strong>hibernate</strong>访问数据库的事务处理。</li></ul><h2 id="处理事务，需要怎么做，做什么"><a href="#处理事务，需要怎么做，做什么" class="headerlink" title="处理事务，需要怎么做，做什么"></a>处理事务，需要怎么做，做什么</h2><p><strong>spring处理事务的模型，使用的步骤都是固定的。把事务使用的信息提供给spring就可以了</strong></p><ol><li><p>事务内部提交，回滚事务，使用的事务管理器对象，代替你完成commit，rollback事务管理器是一个接口和他的众多实现类。</p><ul><li><p>接口：<strong>PlatformTransactionManager</strong> ，定义了事务重要方法 commit ，rollback</p></li><li><p>实现类：spring把每一种数据库访问技术对应的事务处理类都创建好了。<br>mybatis访问数据库—spring创建好的是<strong>DataSourceTransactionManager</strong><br>hibernate访问数据库—-spring创建的是<strong>HibernateTransactionManager</strong></p></li><li><p>怎么使用：你需要告诉spring 你用是那种数据库的访问技术，怎么告诉spring呢？<br>声明数据库访问技术对于的事务管理器实现类， 在spring的配置文件中使用<code>&lt;bean&gt;</code>声明就可以了<br>例如，你要使用mybatis访问数据库，你应该在xml配置文件中<br><code>&lt;bean id=“xxx&quot; class=&quot;...DataSourceTransactionManager&quot;&gt;</code></p></li></ul></li><li><p>你的业务方法需要什么样的事务，说明需要事务的类型。<br>说明方法需要的事务：</p><ol><li><p>事务的隔离级别：有4个值。<br> DEFAULT：采用 DB 默认的事务隔离级别。MySql 的默认为 REPEATABLE_READ； Oracle默认为 READ_COMMITTED。<br> ➢ READ_UNCOMMITTED：读未提交。未解决任何并发问题。<br> ➢ READ_COMMITTED：读已提交。解决脏读，存在不可重复读与幻读。<br> ➢ REPEATABLE_READ：可重复读。解决脏读、不可重复读，存在幻读<br> ➢ SERIALIZABLE：串行化。不存在并发问题。</p></li><li><p>事务的超时时间： 表示一个方法最长的执行时间，如果方法执行时超过了时间，事务就回滚。<br>   单位是秒， 整数值， 默认是 <code>-1</code>. (涉及因素多，一般默认)</p></li><li><p>事务的传播行为 ： 控制业务方法是不是有事务的， 是什么样的事务的。<br>7个传播行为，表示你的业务方法调用时，事务在方法之间是如果使用的。<br>掌握以下三个：</p><ul><li>PROPAGATION_REQUIRED(指定的方法必须在事务内执行。若当前存在事务，就加入到当前事务中；若当前没有事<br>务，则创建一个新事务。)<br><img src="/blog-img/Spring/PROPAGATION_REQUIRED.jpg" alt="PROPAGATION_REQUIRED"></li><li>PROPAGATION_REQUIRES_NEW(指定的方法支持当前事务，但若当前没有事务，也可以以非事务方式执行。)<br><img src="/blog-img/Spring/PROPAGATION_REQUIRES_SUPPORTS.jpg" alt="PROPAGATION_REQUIRES_SUPPORTS"></li><li>PROPAGATION_SUPPORTS(总是新建一个事务，若当前存在事务，就将当前事务挂起，直到新事务执行完毕。)<br><img src="/blog-img/Spring/PROPAGATION_REQUIRES_NEW.jpg" alt="PROPAGATION_REQUIRES_NEW"></li></ul></li></ol></li><li><p>spring提交事务，回滚事务的时机</p><ol><li><p>当你的业务方法，执行成功，没有异常抛出，当方法执行完毕，spring在方法执行后提交事务。事务管理器commit</p></li><li><p>当你的业务方法抛出<strong>运行时异常或ERROR</strong>， spring执行<strong>回滚</strong>，调用事务管理器的rollback<br>运行时异常的定义： RuntimeException  和他的子类都是运行时异常， 例如NullPointException , NumberFormatException</p></li><li><p>当你的业务方法抛出<strong>非运行时异常</strong>， 主要是受查异常时，<strong>提交</strong>事务<br>受查异常：在你写代码中，必须处理的异常。例如IOException, SQLException</p></li></ol></li></ol><h2 id="spring框架中提供的事务处理方案"><a href="#spring框架中提供的事务处理方案" class="headerlink" title="spring框架中提供的事务处理方案"></a>spring框架中提供的事务处理方案</h2><ol><li><p>适合中小项目使用的， 注解方案。<br>spring框架自己用aop实现给业务方法增加事务的功能， 使用<strong>@Transactional</strong>注解增加事务。<strong>@Transactional</strong>注解是spring框架自己注解，放在<strong>public方法</strong>的上面，表示当前方法具有事务。<br>可以给注解的属性赋值，表示具体的<strong>隔离级别，传播行为，异常信息</strong>等等</p><ul><li>使用<strong>@Transactional</strong>的步骤：</li></ul><ol><li><p>需要声明事务管理器对象<br><code>&lt;bean id=&quot;xx&quot; class=&quot;DataSourceTransactionManager&quot;&gt;</code></p></li><li><p>开启事务注解驱动， 告诉spring框架，我要使用注解的方式管理事务。<br><code>&lt;tx:annotation-driven transaction-manager=&quot;transactionManager&quot; /&gt;</code><br>spring使用aop机制，创建<strong>@Transactional</strong>所在的类代理对象，给方法加入事务的功能。<br>在你的业务方法执行之前，先开启事务，在业务方法之后提交或回滚事务，使用aop的环绕通知</p> <figure class="highlight java"><table><tr><td class="code"><pre><span class="line">   <span class="comment">/*</span></span><br><span class="line"><span class="comment">rollbackFor:表示发生指定的异常一定回滚.</span></span><br><span class="line"><span class="comment">   处理逻辑是：</span></span><br><span class="line"><span class="comment">      1) spring框架会首先检查方法抛出的异常是不是在rollbackFor的属性值中</span></span><br><span class="line"><span class="comment">      2) 如果你的抛出的异常不在rollbackFor列表中，spring会判断异常是不是RuntimeException,</span></span><br><span class="line"><span class="comment">             如果是一定回滚。    </span></span><br><span class="line"><span class="comment">  @Transactional(</span></span><br><span class="line"><span class="comment">           propagation = Propagation.REQUIRED,</span></span><br><span class="line"><span class="comment">           isolation = Isolation.DEFAULT,</span></span><br><span class="line"><span class="comment">           readOnly = false,</span></span><br><span class="line"><span class="comment">           rollbackFor = &#123;</span></span><br><span class="line"><span class="comment">                   NullPointerException.class,  NotEnoughException.class</span></span><br><span class="line"><span class="comment">           &#125;</span></span><br><span class="line"><span class="comment">   )*/</span></span><br><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="meta">@Around</span>(<span class="string">"你要增加的事务功能的业务方法名称"</span>)</span><br><span class="line"><span class="function">Object <span class="title">myAround</span><span class="params">()</span></span>&#123;</span><br><span class="line">          <span class="comment">//开启事务，spring给你开启</span></span><br><span class="line"> <span class="keyword">try</span>&#123;</span><br><span class="line">    buy(<span class="number">1001</span>,<span class="number">10</span>);</span><br><span class="line"><span class="comment">//spring的事务管理器.commit();</span></span><br><span class="line"> &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"><span class="comment">//spring的事务管理器.rollback();</span></span><br><span class="line"> &#125; </span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></li></ol></li><li><p>适合大型项目，有很多的类，方法，需要大量的配置事务，使用aspectj框架功能，在spring配置文件中声明类，方法需要的事务。这种方式业务方法和事务配置完全分离。</p><p>实现步骤： 都是在xml配置文件中实现。 </p><ol><li><p>要使用的是aspectj框架，需要加入依赖</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-aspects<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.5.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>声明事务管理器对象</li></ol><p><code>&lt;bean id=&quot;xx&quot; class=&quot;DataSourceTransactionManager&quot;&gt;</code></p><ol start="3"><li><p>声明方法需要的事务类型（配置方法的事务属性【隔离级别，传播行为，超时】）</p></li><li><p>配置aop：指定哪些哪类要创建代理。</p></li></ol><p><strong>spring配置：</strong></p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">数据源配置</span></span><br><span class="line"><span class="comment">.....</span></span><br><span class="line"><span class="comment">.....</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--声明式事务处理：和源代码完全分离的--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--1.声明事务管理器对象--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"myDataSource"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--2.声明业务方法它的事务属性（隔离级别，传播行为，超时时间）</span></span><br><span class="line"><span class="comment">          id:自定义名称，表示 &lt;tx:advice&gt; 和 &lt;/tx:advice&gt;之间的配置内容的</span></span><br><span class="line"><span class="comment">          transaction-manager:事务管理器对象的id</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">"myAdvice"</span> <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--tx:attributes：配置事务属性--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--tx:method：给具体的方法配置事务属性，method可以有多个，分别给不同的方法设置事务属性</span></span><br><span class="line"><span class="comment">                name:1）完整的方法名称，不带有包和类。</span></span><br><span class="line"><span class="comment">2）方法可以使用通配符,* 表示任意字符</span></span><br><span class="line"><span class="comment">                propagation：传播行为，枚举值</span></span><br><span class="line"><span class="comment">                isolation：隔离级别</span></span><br><span class="line"><span class="comment">                rollback-for：你指定的异常类名，全限定类名。 发生异常一定回滚</span></span><br><span class="line"><span class="comment">            --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"buy"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">isolation</span>=<span class="string">"DEFAULT"</span></span></span><br><span class="line"><span class="tag">                       <span class="attr">rollback-for</span>=<span class="string">"java.lang.NullPointerException,cn.JInterest.except.NotEnoughException"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">&lt;!--使用通配符，指定很多的方法,从上往下匹配--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"add*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRES_NEW"</span> /&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--指定修改方法--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"modify*"</span> /&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--删除方法--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"remove*"</span> /&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--查询方法，query，search，find--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"*"</span> <span class="attr">propagation</span>=<span class="string">"SUPPORTS"</span> <span class="attr">read-only</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--配置aop--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--配置切入点表达式：指定哪些包中类，要使用事务</span></span><br><span class="line"><span class="comment">            id:切入点表达式的名称，唯一值</span></span><br><span class="line"><span class="comment">            expression：切入点表达式，指定哪些类要使用事务，aspectj会创建代理对象</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">            com.crm.service</span></span><br><span class="line"><span class="comment">            com.service</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">"servicePt"</span> <span class="attr">expression</span>=<span class="string">"execution(* *..service..*.*(..))"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--配置增强器：关联adivce和pointcut</span></span><br><span class="line"><span class="comment">           advice-ref:通知，上面tx:advice哪里的配置</span></span><br><span class="line"><span class="comment">           pointcut-ref：切入点表达式的id</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">"myAdvice"</span> <span class="attr">pointcut-ref</span>=<span class="string">"servicePt"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol></li></ol><h2 id="总结spring的事务"><a href="#总结spring的事务" class="headerlink" title="总结spring的事务"></a>总结spring的事务</h2><ol><li>管理事务的是 事务管理和他的实现类</li><li>spring的事务是一个统一模型<br> 1）指定要使用的事务管理器实现类，使用<code>&lt;bean&gt;</code><br> 2）指定哪些类，哪些方法需要加入事务的功能<br> 3）指定方法需要的隔离级别，传播行为，超时<br>你需要告诉spring，你的项目中类信息，方法的名称，方法的事务传播行为。</li></ol><h1 id="第6章-Web项目怎么使用容器对象"><a href="#第6章-Web项目怎么使用容器对象" class="headerlink" title="第6章 Web项目怎么使用容器对象"></a><center>第6章 Web项目怎么使用容器对象</center></h1><ul><li><p>web使用容器对象：<br>  servlet接受请求调用service层做数据操作</p>  <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//请求数据...</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">//创建spring的容器对象</span></span><br><span class="line">       String config= <span class="string">"spring.xml"</span>;</span><br><span class="line">       ApplicationContext ctx = <span class="keyword">new</span> ClassPathXmlApplicationContext(config);</span><br><span class="line"></span><br><span class="line">       <span class="comment">//获取service,处理业务</span></span><br><span class="line">StudentService service  = (StudentService) ctx.getBean(<span class="string">"studentService"</span>);</span><br><span class="line">service.addStudent(student);</span><br></pre></td></tr></table></figure><p>  需要的依赖</p>  <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- servlet依赖 --&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"> <span class="comment">&lt;!-- jsp依赖 --&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet.jsp<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jsp-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.1-b03<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>因为web项目是在tomcat服务器上运行的。tomcat启动，项目就一直运行。如果用上面那种方式，获得一次请求就要创建一次ApplicationContext对象，然后把spring.xml文件中所有对象创建出来，同时发送100个请求就要创建100个，垃圾回收器还没来得及回收又创建了，这样很浪费内存</p><p>  <strong>解决方案：</strong> 容器对象创建一次， 把容器对象放入到全局作用域ServletContext中。<br>  <strong>实现：</strong> 使用监听器 当全局作用域对象被创建时 创建容器 存入ServletContext<br>  1）配置web.xml</p>  <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--注册监听器ContextLoaderListener</span></span><br><span class="line"><span class="comment">    监听器被创建对象后，会读取/WEB-INF/spring.xml</span></span><br><span class="line"><span class="comment">    为什么要读取文件：因为在监听器中要创建ApplicationContext对象，需要加载配置文件。</span></span><br><span class="line"><span class="comment">    /WEB-INF/applicationContext.xml就是监听器默认读取的spring配置文件路径</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    可以修改默认的文件位置，使用context-param重新指定文件的位置</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    配置监听器：目的是创建容器对象，创建了容器对象， 就能把spring.xml配置文件中的所有对象都创建好。</span></span><br><span class="line"><span class="comment">    用户发起请求就可以直接使用对象了。</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- contextConfigLocation:表示配置文件的路径  --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--自定义配置文件的路径--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:spring.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br></pre></td></tr></table></figure><p>  2)加入监听器依赖</p>  <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.5.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p>  3)servlet接受请求调用service层做数据操作</p>  <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//使用框架中的方法，获取容器对象</span></span><br><span class="line">WebApplicationContext ctx = <span class="keyword">null</span>;</span><br><span class="line">        ServletContext sc = getServletContext();</span><br><span class="line">        ctx = WebApplicationContextUtils.getRequiredWebApplicationContext( sc );</span><br><span class="line">        System.out.println(<span class="string">"容器对象的信息========"</span>+ctx);</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取service,处理业务</span></span><br><span class="line">StudentService service  = (StudentService) ctx.getBean(<span class="string">"studentService"</span>);</span><br><span class="line">service.addStudent(student);</span><br></pre></td></tr></table></figure></li><li><p>WebApplicationContext底层实现<br>查其源码，看其调用关系，就可看到其是从 ServletContext 中读取的属性值，即 Spring容器。<br>  <img src="/blog-img/Spring/ServletContext%E4%B8%AD%E8%AF%BB%E5%8F%96%E7%9A%84%E5%B1%9E%E6%80%A7%E5%80%BC.jpg" alt=""><br>  (容器对象在 ServletContext 的中存放的 key 为 WebApplicationContext.ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE。)</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> java框架 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java框架 </tag>
            
            <tag> Spring </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mybatis</title>
      <link href="/posts/Mybatis/"/>
      <url>/posts/Mybatis/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\css\APlayer.min.css"><script src="\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\js\Meting.min.js"></script><h1 id="第一章-框架概述"><a href="#第一章-框架概述" class="headerlink" title="第一章 框架概述"></a><center>第一章 框架概述</center></h1><h2 id="软件开发常用结构"><a href="#软件开发常用结构" class="headerlink" title="软件开发常用结构"></a>软件开发常用结构</h2><h3 id="三层架构"><a href="#三层架构" class="headerlink" title="三层架构"></a>三层架构</h3><div class="note info">            <p>界面层（User Interface layer）、业务逻辑层（Business Logic Layer）、数据访问层（Data access layer）</p>          </div><ul><li><p><strong>三层的职责:</strong></p><ol><li>界面层（表示层，视图层）：主要功能是接受用户的数据，显示请求的处理结果。使用 web 页面和<br>用户交互，手机 app 也就是表示层的，用户在 app 中操作，业务逻辑在服务器端处理。</li><li>业务逻辑层：接收表示传递过来的数据，检查数据，计算业务逻辑，调用数据访问层获取数据。</li><li>数据访问层：与数据库打交道。主要实现对数据的增、删、改、查。将存储在数据库中的数据提交<br>给业务层，同时将业务层处理的数据保存到数据库</li></ol></li></ul><ul><li><p><strong>三层的处理请求的交互：</strong></p><div class="note info">            <p>用户—&gt; 界面层—&gt;业务逻辑层—&gt;数据访问层—&gt;DB 数据库</p>          </div><p><img src="/blog-img/Mybatis/pasted-3.png" alt="upload successful"></p></li><li><p><strong>为什么要使用三层？</strong></p><ol><li>结构清晰、耦合度低, 各层分工明确</li><li>可维护性高，可扩展性高</li><li>有利于标准化</li><li>开发人员可以只关注整个结构中的其中某一层的功能实现</li><li>有利于各层逻辑的复用</li></ol></li></ul><h3 id="常用框架"><a href="#常用框架" class="headerlink" title="常用框架"></a>常用框架</h3><ul><li><p><strong>常见的 J2EE 中开发框架：</strong></p><blockquote><p>MyBatis 框架：<br>MyBatis 是一个优秀的基于 java 的持久层框架，内部封装了 jdbc，开发者只需要关注 sql 语句<br>本身，而不需要处理加载驱动、创建连接、创建 statement、关闭连接，资源等繁杂的过程。<br>MyBatis 通过 xml 或注解两种方式将要执行的各种 sql 语句配置起来，并通过 java 对象和 sql 的<br>动态参数进行映射生成最终执行的 sql 语句，最后由 mybatis 框架执行 sql 并将结果映射为 java<br>对象并返回。</p></blockquote><blockquote><p>Spring 框架：<br>Spring 框架为了解决软件开发的复杂性而创建的。Spring 使用的是基本的 JavaBean 来完成以前<br>非常复杂的企业级开发。Spring 解决了业务对象，功能模块之间的耦合，不仅在 javase,web 中使用，<br>大部分 Java 应用都可以从 Spring 中受益。<br>Spring 是一个轻量级控制反转(IoC)和面向切面(AOP)的容器。</p></blockquote><blockquote><p>SpringMVC 框架<br>Spring MVC 属于 SpringFrameWork 3.0 版本加入的一个模块，为 Spring 框架提供了构建 Web<br>应用程序的能力。现在可以 Spring 框架提供的 SpringMVC 模块实现 web 应用开发，在 web 项目中<br>可以无缝使用 Spring 和 Spring MVC 框架。</p></blockquote></li></ul><h2 id="框架是什么"><a href="#框架是什么" class="headerlink" title="框架是什么"></a>框架是什么</h2><ul><li><p><strong>框架定义</strong></p><blockquote><p>框架（Framework）是整个或部分系统的可重用设计，表现为一组抽象构件及构件实例间交互的方<br>法;另一种认为，框架是可被应用开发者定制的应用骨架、模板。<br>简单的说，框架其实是半成品软件，就是一组组件，供你使用完成你自己的系统。从另一个角度来<br>说框架一个舞台，你在舞台上做表演。在框架基础上加入你要完成的功能。<br>框架安全的，可复用的，不断升级的软件。</p></blockquote></li><li><p><strong>框架解决的问题</strong></p><blockquote><p>框架要解决的最重要的一个问题是技术整合，在 J2EE 的 框架中，有着各种各样的技术，不同的应<br>用，系统使用不同的技术解决问题。需要从 J2EE 中选择不同的技术，而技术自身的复杂性，有导致更<br>大的风险。企业在开发软件项目时，主要目的是解决业务问题。 即要求企业负责技术本身，又要求解<br>决业务问题。这是大多数企业不能完成的。框架把相关的技术融合在一起，企业开发可以集中在业务领<br>域方面。<br>另一个方面可以提供开发的效率。</p></blockquote></li></ul><h2 id="JDBC-编程"><a href="#JDBC-编程" class="headerlink" title="JDBC 编程"></a>JDBC 编程</h2><ul><li><p><strong>使用 JDBC 编程的回顾</strong>(展开查看代码)</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">findStudent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Connection conn = <span class="keyword">null</span>;</span><br><span class="line">        Statement stmt = <span class="keyword">null</span>;</span><br><span class="line">        ResultSet rs = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line"><span class="comment">//注册 mysql 驱动 MySQL8.0 连接(com.mysql.cj.jdbc.Driver)</span></span><br><span class="line">Class.forName(<span class="string">"com.mysql.jdbc.Driver"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//连接数据的基本信息 url ，username，password</span></span><br><span class="line">String url = <span class="string">"jdbc:mysql://localhost:3306/springdb"</span>;<span class="comment">//MySQL8.0 需要加上  ?useSSL=false&amp;amp;serverTimezone=UTC</span></span><br><span class="line">String username = <span class="string">"root"</span>;</span><br><span class="line">String password = <span class="string">"123456"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建连接对象</span></span><br><span class="line">conn = DriverManager.getConnection(url, username, password);</span><br><span class="line"></span><br><span class="line"><span class="comment">//保存查询结果</span></span><br><span class="line">List&lt;Student&gt; stuList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建 Statement, 用来执行 sql 语句</span></span><br><span class="line">stmt = conn.createStatement();</span><br><span class="line"></span><br><span class="line"><span class="comment">//执行查询，创建记录集，</span></span><br><span class="line">rs = stmt.executeQuery(<span class="string">"select * from student"</span>);</span><br><span class="line"><span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">Student stu = <span class="keyword">new</span> Student();</span><br><span class="line">stu.setId(rs.getInt(<span class="string">"id"</span>));</span><br><span class="line">stu.setName(rs.getString(<span class="string">"name"</span>));</span><br><span class="line">stu.setAge(rs.getInt(<span class="string">"age"</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//从数据库取出数据转为 Student 对象，封装到 List 集合</span></span><br><span class="line">stuList.add(stu);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"><span class="comment">//关闭资源</span></span><br><span class="line"><span class="keyword">if</span> (rs != <span class="keyword">null</span>) ;</span><br><span class="line">&#123;</span><br><span class="line">rs.close();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (stmt != <span class="keyword">null</span>) &#123;</span><br><span class="line">stmt.close();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (conn != <span class="keyword">null</span>) &#123;</span><br><span class="line">conn.close();</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line">        &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>使用 JDBC 的缺陷</strong></p><ol><li>代码比较多，开发效率低</li><li>需要关注 Connection ,Statement, ResultSet 对象创建和销毁</li><li>对 ResultSet 查询的结果，需要自己封装为 List</li><li>重复的代码比较多些</li><li>业务代码和数据库的操作混在一起</li></ol></li></ul><h2 id="MyBatis-框架概述"><a href="#MyBatis-框架概述" class="headerlink" title="MyBatis 框架概述"></a>MyBatis 框架概述</h2><blockquote><p>MyBatis 框架：<br>MyBatis 本是 apache 的一个开源项目 iBatis, 2010 年这个项目由 apache software foundation 迁<br>移到了 google code，并且改名为 MyBatis 。2013 年 11 月迁移到 Github。<br>iBATIS 一词来源于“internet”和“abatis”的组合，是一个基于 Java 的持久层框架。iBATIS 提供的<br>持久层框架包括 SQL Maps 和 Data Access Objects（DAOs）<br>当前，最新版本是 MyBatis 3.5.1 ，其发布时间是 2019 年 4 月 8 日。</p></blockquote><ul><li><strong>MyBatis 解决的主要问题</strong><ul><li><mark>减轻使用 JDBC 的复杂性，不用编写重复的创建 Connetion , Statement ; 不用编写关闭资源代码。直接使用 java 对象，表示结果数据。让开发者专注 SQL 的处理。 其他分心的工作由 MyBatis 代劳。</mark></li></ul></li></ul><h1 id="第二章-MyBatis-框架快速入门"><a href="#第二章-MyBatis-框架快速入门" class="headerlink" title="第二章 MyBatis 框架快速入门"></a><center>第二章 MyBatis 框架快速入门</center></h1><h2 id="入门案例"><a href="#入门案例" class="headerlink" title="入门案例"></a>入门案例</h2><p><strong>使用 Mybatis 准备</strong></p><blockquote><p>下载 mybatis<br><a href="https://github.com/mybatis/mybatis-3/releases" target="_blank" rel="noopener">https://github.com/mybatis/mybatis-3/releases</a></p></blockquote><p><strong>搭建 MyBatis 开发环境</strong></p><ol><li><p>创建 mysql 数据库和相关的表</p> <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">    <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`student`</span> (</span><br><span class="line"> <span class="string">`id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> ,</span><br><span class="line"> <span class="string">`name`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line"> <span class="string">`email`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line"> <span class="string">`age`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line"> PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br></pre></td></tr></table></figure></li><li><p>创建 maven 工程 </p><p> <img src="/blog-img/Mybatis/pasted-4.png" alt="upload successful"></p></li><li><p>加入依赖和插件</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--单元测试--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--mybatis--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--mysql--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"> <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    对于MAVEN项目，Eclipse会自动把项目src\main\java\目录下的配置文件（.xml）和</span></span><br><span class="line"><span class="comment">    资源文件(.properties)搬运到target目录下，而intellij idea默认是不会帮我们做这件事的,</span></span><br><span class="line"><span class="comment">    所以需要加以下配置</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/java<span class="tag">&lt;/<span class="name">directory</span>&gt;</span><span class="comment">&lt;!--所在的目录--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">includes</span>&gt;</span><span class="comment">&lt;!--包括目录下的.properties,.xml 文件都会扫描到--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>false<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--编译时跳过单元测试--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-surefire-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">skipTests</span>&gt;</span>true<span class="tag">&lt;/<span class="name">skipTests</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">source</span>&gt;</span>11<span class="tag">&lt;/<span class="name">source</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">target</span>&gt;</span>11<span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>编写 Student 实体类<br> 在domain包下创建</p> <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">  <span class="comment">//属性名和列名一样 </span></span><br><span class="line">  <span class="keyword">private</span> Integer id;</span><br><span class="line">  <span class="keyword">private</span> String name;</span><br><span class="line">  <span class="keyword">private</span> String email;</span><br><span class="line">  <span class="keyword">private</span> Integer age;</span><br><span class="line">  <span class="comment">// set ,get , toString</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>编写 Dao 接口 StudentDao<br> 在dao包下创建</p>   <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StudentDao</span> </span>&#123;</span><br><span class="line"><span class="comment">/*查询所有数据*/</span></span><br><span class="line">  <span class="function">List&lt;Student&gt; <span class="title">selectStudents</span><span class="params">()</span></span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></li><li><p>编写 Dao 接口 Mapper 映射文件 StudentDao.xml</p><p>要求：</p><ol><li><p>在 dao 包中创建文件 StudentDao.xml</p></li><li><p>要 StudentDao.xml 文件名称和接口 StudentDao 一样，区分大小写。</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">    <span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">             namespace：必须有值，自定义的唯一字符串 </span></span><br><span class="line"><span class="comment">             推荐使用：dao 接口的全限定名称 </span></span><br><span class="line"><span class="comment">        --&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.test.dao.StudentDao"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">            &lt;select&gt;: 查询数据， 标签中必须是 select 语句</span></span><br><span class="line"><span class="comment">            id: sql 语句的自定义名称，推荐使用 dao 接口中方法名称， </span></span><br><span class="line"><span class="comment">            使用名称表示要执行的 sql 语句</span></span><br><span class="line"><span class="comment">            resultType: 查询语句的返回结果数据类型，使用全限定类名 </span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectStudents"</span> <span class="attr">resultType</span>=<span class="string">"com.test.domain.Student"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--要执行的 sql 语句--&gt;</span></span><br><span class="line">            select id,name,email,age from student</span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol></li><li><p>创建 MyBatis 主配置文件</p><p>项目 src/main 下创建 resources 目录，设置 resources 目录为 resources root<br>创建主配置文件：名称为 mybatis.xml<br>说明：主配置文件名称是自定义的，内容如下：</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置 mybatis 环境--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--id:数据源的名称--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--配置事务类型：使用 JDBC 事务（使用 Connection 的提交和回滚）--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--数据源 dataSource：创建数据库 Connection 对象</span></span><br><span class="line"><span class="comment">                type: POOLED 使用数据库的连接池 </span></span><br><span class="line"><span class="comment">            --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--连接数据库的四个要素--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.cj.jdbc.Driver"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/mydbtest?useUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=utf-8<span class="symbol">&amp;amp;</span>serverTimezone=GMT"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--告诉 mybatis 要执行的 sql 语句的位置--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com\test\mapper\StudentMapper.xml"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>创建测试类 MyBatisTest</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testStart</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">     String config = <span class="string">"mybatis-config.xml"</span>;<span class="comment">//1.mybatis 主配置文件 </span></span><br><span class="line"></span><br><span class="line">     InputStream in = Resources.getResourceAsStream(config); <span class="comment">//2.读取配置文件 </span></span><br><span class="line"></span><br><span class="line">     SqlSessionFactory factory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(in);<span class="comment">//3.创建 SqlSessionFactory 对象,目的是获取 SqlSession </span></span><br><span class="line"></span><br><span class="line">     SqlSession session = factory.openSession(); <span class="comment">//4.获取 SqlSession,SqlSession 能执行 sql 语句</span></span><br><span class="line"></span><br><span class="line">     List&lt;Student&gt; studentList =session.selectList(<span class="string">"com.test.dao.StudentDao.selectStudents"</span>);<span class="comment">//5.执行 SqlSession 的 selectList("namespace.id")</span></span><br><span class="line"></span><br><span class="line">     studentList.forEach( student -&gt; System.out.println(student)); <span class="comment">//6.循环输出查询结果 </span></span><br><span class="line"></span><br><span class="line">     session.close();<span class="comment">//7.关闭 SqlSession，释放资源</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>配置日志功能</p><p>mybatis.xml 文件加入日志配置，可以在控制台输出执行的 sql 语句和参数</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"logImpl"</span> <span class="attr">value</span>=<span class="string">"STDOUT_LOGGING"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="基本的-CURD"><a href="#基本的-CURD" class="headerlink" title="基本的 CURD"></a>基本的 CURD</h2><blockquote><p>insert ,update ,delete , selectOne（查询一个）</p></blockquote><h3 id="insert"><a href="#insert" class="headerlink" title="insert"></a>insert</h3><ol><li><p>StudentDao 接口中增加方法</p><p>  <code>int insertStudent(Student student);</code></p></li><li><p>StudentDao.xml 加入 sql 语句</p>  <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"insertStudent"</span>&gt;</span></span><br><span class="line"> insert into student(id,name,email,age) values(#&#123;id&#125;,#&#123;name&#125;,#&#123;email&#125;,#&#123;age&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>增加测试方法</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testInsert</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">       </span><br><span class="line">        String config = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream in =Resources.getResourceAsStream(config);</span><br><span class="line">        SqlSessionFactory factory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(in);</span><br><span class="line">        SqlSession session = factory.openSession();</span><br><span class="line"></span><br><span class="line">        Student student = <span class="keyword">new</span> Student();</span><br><span class="line">        student.setId(<span class="number">1005</span>);</span><br><span class="line">        student.setName(<span class="string">"张三"</span>);</span><br><span class="line">        student.setEmail(<span class="string">"zhangsan@163.com"</span>);</span><br><span class="line">        student.setAge(<span class="number">20</span>);</span><br><span class="line">        <span class="comment">//执行插入 insert</span></span><br><span class="line">       <span class="keyword">int</span> rows =session.insert(<span class="string">"com.test.dao.StudentDao.insertStudent"</span>,student);</span><br><span class="line">        <span class="comment">//MyBatis默认情况下是手动提交事务</span></span><br><span class="line">        session.commit();</span><br><span class="line">        System.out.println(<span class="string">"增加记录的行数:"</span>+rows);</span><br><span class="line">        <span class="comment">//8.关闭 SqlSession</span></span><br><span class="line">        session.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h3 id="…"><a href="#…" class="headerlink" title="…"></a>…</h3><pre><code>删改查操作类似，只需要在mapper文件中写sql语句就可以了</code></pre><h2 id="主要类的介绍"><a href="#主要类的介绍" class="headerlink" title="主要类的介绍"></a>主要类的介绍</h2><ol><li><p><strong>Resources</strong>： mybatis中的一个类， 负责读取主配置文件</p><pre><code>InputStream in = Resources.getResourceAsStream(&quot;mybatis.xml&quot;); </code></pre></li><li><p><strong>SqlSessionFactoryBuilder</strong>: 创建SqlSessionFactory对象</p><pre><code>SqlSessionFactoryBuilder builder  = new SqlSessionFactoryBuilder();//创建SqlSessionFactory对象 SqlSessionFactory factory = builder.build(in); </code></pre></li><li><p><strong>SqlSessionFactory</strong> ：重量级对象，程序创建一个对象耗时比较长，使用资源    比较多。在整个项目中，有一个就够用了。<br> SqlSessionFactory: 接口实现类：DefaultSqlSessionFactory<br>SqlSessionFactory作用：获取SqlSession对象, SqlSession sqlSession = factory.openSession()<br> openSession()方法说明：</p><pre><code>1. openSession()：无参数的，获取是非自动提交事务的SqlSession对象2. openSession(boolean):         openSession(true) 获取自动提交事务的SqlSession.         openSession(false) 非自动提交事务的SqlSession对象</code></pre></li></ol><ol start="4"><li><p><strong>SqlSession</strong>: </p><p> SqlSession接口 ：定义了操作数据的方法 例如 selectOne() ,selectList() ,insert(),update(), delete(), commit(), rollback()</p><pre><code>SqlSession接口的实现类DefaultSqlSession。</code></pre><p>  使用要求： SqlSession对象不是线程安全的，需要在方法内部使用， 在执行sql语句之前，使用openSession()获取SqlSession对象。</p><pre><code>在执行完sql语句后，需要关闭它，执行SqlSession.close(). 这样能保证他的使用是线程安全的。</code></pre></li></ol><h2 id="传统-Dao-开发方式的分析"><a href="#传统-Dao-开发方式的分析" class="headerlink" title="传统 Dao 开发方式的分析"></a>传统 Dao 开发方式的分析</h2><blockquote><p>Dao 的实现类其实并没有干什么实质性的工作，它仅仅就是通过 SqlSession 的相关 API 定位到映射文件 mapper 中相应 id 的 SQL 语句，真正对 DB 进行操作的工作其实是由框架通过 mapper 中的 SQL 完成的。</p></blockquote><blockquote><p>所以，MyBatis 框架就抛开了 Dao 的实现类，直接定位到映射文件 mapper 中的相应 SQL 语句，对DB 进行操作。这种对 Dao 的实现方式称为 Mapper 的动态代理方式。</p></blockquote><blockquote><p>Mapper 动态代理方式无需程序员实现 Dao 接口。接口是由 MyBatis 结合映射文件自动生成的动态代<br>理实现的。</p></blockquote><h1 id="第3章-MyBatis-框架-Dao-代理"><a href="#第3章-MyBatis-框架-Dao-代理" class="headerlink" title="第3章 MyBatis 框架 Dao 代理"></a><center>第3章 MyBatis 框架 Dao 代理</center></h1><h2 id="动态代理"><a href="#动态代理" class="headerlink" title="动态代理"></a>动态代理</h2><ul><li><p>使用SqlSession.getMapper(dao接口.class) 获取这个dao接口的对象</p><p> <code>SqlSession session = factory.openSession();</code><br>  <code>StudentDao dao = session.getMapper(StudentDao.class);</code></p><p> 得到的是MapperProxy 对象（具体看源码）</p></li></ul><p><img src="/blog-img/Mybatis/pasted-5.png" alt="upload successful"></p><h2 id="传入参数-了解"><a href="#传入参数-了解" class="headerlink" title="传入参数(了解)"></a>传入参数(了解)</h2><p><strong>从java代码中把数据传入到mapper文件的sql语句中。</strong></p><ol><li><p><strong>parameterType</strong> ：<br> 写在mapper文件中的 一个属性。 表示dao接口中方法的参数的数据类型。</p> <div class="note warning">            <p>mapper文件中 parameterType一般省略不写，mybatis能自动识别。</p>          </div> <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"> <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        &lt;select&gt;中parameterType可以不写</span></span><br><span class="line"><span class="comment">                  resultType必须有</span></span><br><span class="line"><span class="comment">        &lt;insert&gt;&lt;update&gt;&lt;delete&gt;中通常只写 id 属性</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectById"</span> <span class="attr">parameterType</span>=<span class="string">"java.lang.String"</span> <span class="attr">resultType</span>=<span class="string">"com.test.domain.Student"</span>&gt;</span></span><br><span class="line">    select * from t_student where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><ol start="2"><li><p><strong>一个简单类型的参数</strong>：</p><p> 简单类型： mybatis把java的<strong>基本数据类型</strong>和<strong>String</strong>都叫简单类型。<br> 在mapper文件获取简单类型的一个参数的值，使用 #{<strong>任意字符</strong>}</p><p> <strong>接口</strong>：<code>public Student  selectStudentById(Integer id)</code><br> <strong>mapper</strong>:<code>select id,name, email,age from student where id=#{studentId}</code></p></li><li><p><strong>多个参数，使用java对象</strong></p><pre><code>vo: value object , 放一些存储数据的类。比如说 提交请求参数， name ,age 现在想把name ,age 传给一个service 类。vo: view object , 从servlet把数据返回给浏览器使用的类，表示显示结果的类。pojo: 普通的有set， get方法的java类。 普通的java对象Servlet --- StudentService( addStudent( MyParam  param)  )entity（domain域）: 实体类， 和数据库中的表对应的类</code></pre><p> <em>语法 #{对象中的属性名}</em></p><p> <strong>接口方法</strong>：<br> <code>List&lt;Student&gt; find(Student s)</code><br> <strong>mapper 文件</strong>：<br> <code>&lt;select id=&quot;addStu&quot; &gt;</code><br> <code>select id,name,email,age from student where name=#{sname} or age = #{sage}</code><br> <code>&lt;/select&gt;</code></p></li><li><p><strong>多个参数，使用Map</strong></p><p>Map 集合可以存储多个值，使用Map向 mapper 文件一次传入多个参数。Map 集合使用 String的 key，<br>Object 类型的值存储参数。 mapper 文件使用 # { key } 引用参数值。</p><p>例如：<br><code>Map&lt;String,Object&gt; data = new HashMap&lt;String,Object&gt;();</code><br><code>data.put(“myname”,”李力”);</code><br><code>data.put(“myage”,20);</code><br><strong>接口方法</strong>：<br><code>List&lt;Student&gt; selectMultiMap(Map&lt;String,Object&gt; map);</code><br><strong>mapper 文件</strong>：<br><code>&lt;select id=&quot;selectMultiMap&quot; resultType=&quot;com.test.domain.Student&quot;&gt;</code><br><code>select id,name,email,age from student where name=#{myname} or age =#{myage}</code><br><code>&lt;/select&gt;</code></p></li><li><p><strong>#{}和${}区别</strong></p><ul><li><p><strong>#</strong>使用 <code>？</code>在sql语句中做占位的， 使用PreparedStatement执行sql，效率高</p></li><li><p><strong>#</strong>能够避免sql注入，更安全。</p></li><li><p><strong>$</strong>不使用占位符，是字符串连接方式，使用Statement对象执行sql，效率低</p></li><li><p><strong>$</strong>有sql注入的风险，缺乏安全性。</p></li><li><p><strong>$</strong>:可以替换表名或者列名</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"> <span class="keyword">select</span> <span class="keyword">id</span> , <span class="keyword">name</span>, email , age <span class="keyword">from</span> student <span class="keyword">where</span> <span class="keyword">id</span> = <span class="string">'#'</span>&#123;studentId&#125;</span><br><span class="line">  </span><br><span class="line"> <span class="comment">#&#123;&#125; 的结果： select id , name, email , age from student where id = ? </span></span><br><span class="line"></span><br><span class="line"> <span class="keyword">select</span> <span class="keyword">id</span> , <span class="keyword">name</span>, email , age <span class="keyword">from</span> student <span class="keyword">where</span> <span class="keyword">id</span> = $ &#123;studentId&#125;</span><br><span class="line"></span><br><span class="line"> $&#123;&#125; 的结果：</span><br><span class="line">  <span class="keyword">select</span> <span class="keyword">id</span> , <span class="keyword">name</span> , email , age <span class="keyword">from</span> student <span class="keyword">where</span> <span class="keyword">id</span> =<span class="number">1001</span></span><br><span class="line">相当于：</span><br><span class="line">  <span class="keyword">String</span> <span class="keyword">sql</span>=<span class="string">"select id ,name , email ,age from student where id="</span> + <span class="string">"1001"</span>;</span><br><span class="line"> </span><br><span class="line"> $:可以替换表名或者列名， 你能确定数据是安全的。可以使用$</span><br></pre></td></tr></table></figure></li></ul></li></ol><h2 id="mybatis的输出结果"><a href="#mybatis的输出结果" class="headerlink" title="mybatis的输出结果"></a>mybatis的输出结果</h2><ul><li>mybatis执行了sql语句，得到java对象。</li></ul><h3 id="resultType"><a href="#resultType" class="headerlink" title="resultType"></a>resultType</h3><ol><li><p>指sql语句执行完毕后,数据转为的java对象,java类型是任意的。<br>resultType结果类型的它值 (1)类型的全限定名称 (2)类型的别名， 例如 java.lang.Integer别名是int</p><p> <strong>处理方式：</strong></p><ol><li><p>mybatis执行sql语句， 然后mybatis调用类的无参数构造方法，创建对象。</p></li><li><p>mybatis把ResultSet指定列值付给同名的属性。<br><code>&lt;select id=&quot;selectMultiPosition&quot; resultType=&quot;com.bjpowernode.domain.Student&quot;&gt;</code><br><code>select id,name, email,age from student</code><br><code>&lt;/select&gt;</code></p><p>对等的jdbc:<br>ResultSet rs = executeQuery(“ select id,name, email,age from student” )<br> while(rs.next()){</p><pre><code>Student  student = new Student();student.setId(rs.getInt(&quot;id&quot;));student.setName(rs.getString(&quot;name&quot;))</code></pre><p>}</p></li></ol></li><li><p>定义自定义类型的别名</p><ol><li>在mybatis主配置文件中定义，使<code>&lt;typeAlias&gt;</code>定义别名</li><li>可以在resultType中使用自定义别名<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--为mapper映射文件中的domain起别名--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--&lt;typeAlias type="com.test.domain.Student" alias="stu" /&gt;--&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--package 批量起别名 系统取好了，别名为类名（区分大小写）--&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.test.domain"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol></li></ol><h3 id="resultMap"><a href="#resultMap" class="headerlink" title="resultMap:"></a>resultMap:</h3><ul><li><p>结果映射， 指定列名和java对象的属性对应关系。</p><ol><li><p>你自定义列值赋值给哪个属性</p></li><li><p>当你的列名和属性名不一样时，一定使用resultMap</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">数据库表不变，现在有一个类属性名和字段对应不上的情况</span></span><br><span class="line"><span class="comment">type：指定一个类型，与数据库表一一对应，建立起表字段和类属性的名字一一匹配的关系</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"stuMap"</span> <span class="attr">type</span>=<span class="string">"Student"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">id:定义主键</span></span><br><span class="line"><span class="comment">property:类中的属性名</span></span><br><span class="line"><span class="comment">column: 表中的字段名</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"sid"</span> <span class="attr">column</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"sname"</span> <span class="attr">column</span>=<span class="string">"name"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"sage"</span> <span class="attr">column</span>=<span class="string">"age"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectAll2"</span> <span class="attr">resultMap</span>=<span class="string">"stuMap"</span>&gt;</span></span><br><span class="line">select * from t_student</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol></li><li><p>resultMap和resultType不要一起用，二选一</p></li></ul><h1 id="第4章-MyBatis-框架动态-SQL"><a href="#第4章-MyBatis-框架动态-SQL" class="headerlink" title="第4章 MyBatis 框架动态 SQL"></a><center>第4章 MyBatis 框架动态 SQL</center></h1><h2 id="动态sql"><a href="#动态sql" class="headerlink" title="动态sql"></a>动态sql</h2><blockquote><p>sql的内容是变化的，可以根据条件获取到不同的sql语句。<strong>主要是where部分发生变化。</strong></p></blockquote><p><strong>动态sql的实现:</strong> 使用mybatis提供的标签，<code>&lt;if&gt; ,&lt;where&gt;,&lt;foreach&gt;</code></p><ol><li><p><code>&lt;if&gt;</code>是判断条件的，语法</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"判断java对象的属性值"</span>&gt;</span></span><br><span class="line">           部分sql语句</span><br><span class="line"><span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p><code>&lt;where&gt;</code>用来包含 多个<code>&lt;if&gt;</code>的,当多个if有一个成立的,<code>&lt;where&gt;</code>会自动增加一个where关键字,并去掉 if中多余的 and ,or等。</p> <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"find"</span> <span class="attr">resultType</span>=<span class="string">"student"</span>&gt;</span></span><br><span class="line">       select * from t_student</span><br><span class="line">       <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">           where搭配if标签使用  通过if标签来判断</span></span><br><span class="line"><span class="comment">           如果查询条件不匹配 则不在sql中加where关键字</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">           where 忽略第一个and</span></span><br><span class="line"><span class="comment">       --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"name!=null and name!=''"</span>&gt;</span></span><br><span class="line">               <span class="comment">&lt;!--'%'中间加空格--&gt;</span></span><br><span class="line">               and name like '%' #&#123;name&#125; '%'</span><br><span class="line">           <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"address!=null and address!=''"</span>&gt;</span></span><br><span class="line">               and address like '%' #&#123;address&#125; '%'</span><br><span class="line">           <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p><code>&lt;foreach&gt;</code> 循环java中的数组，list集合的。 主要用在sql的in语句中。</p><p> <code>&lt;foreach collection=&quot;&quot; item=&quot;&quot; open=&quot;&quot; close=&quot;&quot; separator=&quot;&quot;&gt;</code><br> <code>#{xxx}</code><br> <code>&lt;/foreach&gt;</code></p><blockquote><p>collection:表示接口中的方法参数的类型， 如果是数组使用array , 如果是list集合使用list<br>   item:自定义的，表示数组和集合成员的变量<br>   open:循环开始时的字符<br>   close:循环结束时的字符<br>   separator:集合成员之间的分隔符</p></blockquote><p> 例如：学生id是 1001,1002,1003的三个学生<br>  select * from student where id in (1001,1002,1003)</p><figure class="highlight xml"><figcaption><span>java</span></figcaption><table><tr><td class="code"><pre><span class="line">public List<span class="tag">&lt;<span class="name">Student</span>&gt;</span> selectByidS(List<span class="tag">&lt;<span class="name">Integer</span>&gt;</span> idlist)</span><br><span class="line"></span><br><span class="line">List<span class="tag">&lt;<span class="name">Integer</span>&gt;</span> list = new ...</span><br><span class="line">list.add(1001);</span><br><span class="line">list.add(1002);</span><br><span class="line">list.add(1003);</span><br><span class="line"></span><br><span class="line">dao.selectByids(list)</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectByIds"</span> <span class="attr">resultType</span>=<span class="string">"student"</span>&gt;</span></span><br><span class="line">      select * from t_student</span><br><span class="line">      where id in</span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"array"</span> <span class="attr">item</span>=<span class="string">"id"</span> <span class="attr">open</span>=<span class="string">"("</span> <span class="attr">close</span>=<span class="string">")"</span> <span class="attr">separator</span>=<span class="string">","</span>&gt;</span></span><br><span class="line">          #&#123;id&#125;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>sql代码片段,就是复用一些语法,代替重复性高，且复杂的子查询</p><p> 步骤<br> 1.先定义 <code>&lt;sql id=&quot;自定义名称唯一&quot;&gt;  sql语句， 表名，字段等 &lt;/sql&gt;</code><br> 2.再使用，<code>&lt;include refid=&quot;id的值&quot; /&gt;</code></p> <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">"selectAll"</span> &gt;</span></span><br><span class="line">   select * from t_student</span><br><span class="line"><span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectById3"</span> <span class="attr">resultType</span>=<span class="string">"student"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"selectAll"</span> /&gt;</span> where id=#&#123;id&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>一般不用  会减低代码可读性</li></ul></li><li><p>… </p></li></ol><h1 id="第5章-MyBatis-配置文件（掌握）"><a href="#第5章-MyBatis-配置文件（掌握）" class="headerlink" title=" 第5章 MyBatis 配置文件（掌握）"></a><center> 第5章 MyBatis 配置文件（掌握）</center></h1><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--使用配置文件加载数据库连接属性--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">"db.properties"</span>&gt;</span><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    &lt;settings&gt;</span></span><br><span class="line"><span class="comment">        &lt;setting name="" value=""/&gt;</span></span><br><span class="line"><span class="comment">    &lt;/settings&gt;</span></span><br><span class="line"><span class="comment">    设置与数据库交互环境</span></span><br><span class="line"><span class="comment">        例如可以在此处配置二级缓存，配置查询延迟加载策略等等。。</span></span><br><span class="line"><span class="comment">            配置的目的是为了更有效的查询表中的记录</span></span><br><span class="line"><span class="comment">            实际开发中基本没用 效果不明显 现在有其他策略</span></span><br><span class="line"><span class="comment">            基础操作</span></span><br><span class="line"><span class="comment">                对于常用的查询条件的字段，设置索引</span></span><br><span class="line"><span class="comment">            高级操作</span></span><br><span class="line"><span class="comment">                使用nosql数据库，redis</span></span><br><span class="line"><span class="comment">            专业操作</span></span><br><span class="line"><span class="comment">                Elasticsearch与Solr 针对于电商行业</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--为mapper映射文件中的domain起别名--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&lt;typeAlias type="com.test.domain.Student" alias="stu" /&gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--package 批量起别名 系统取好了，别名为类名（区分大小写）--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.test.domain"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置 mybatis 环境--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!--id:数据源的名称--&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">              <span class="comment">&lt;!--配置事务类型：使用 JDBC 事务（使用 Connection 的提交和回滚）--&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></span><br><span class="line">              <span class="comment">&lt;!--数据源 dataSource：创建数据库 Connection 对象</span></span><br><span class="line"><span class="comment">                  type: POOLED 使用数据库的连接池 </span></span><br><span class="line"><span class="comment">              --&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">                  <span class="comment">&lt;!--使用`$&#123;&#125;`读取配置文件，连接数据库的四个要素--&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.driver&#125;"</span>/&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.url&#125;"</span>/&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.username&#125;"</span>/&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.password&#125;"</span>/&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&lt;mapper resource="com\test\dao\StudentDao.xml"/&gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&lt;mapper class="com.test.dao.StudentDao" /&gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--该包下的mapper映射文件自动注册--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.test.dao"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="第6章-扩展"><a href="#第6章-扩展" class="headerlink" title="第6章 扩展"></a><center>第6章 扩展</center></h1>]]></content>
      
      
      <categories>
          
          <category> java框架 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Mybatis </tag>
            
            <tag> java框架 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>idea-Error(3, 32) java程序包不存在的问题</title>
      <link href="/posts/javaError1/"/>
      <url>/posts/javaError1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\css\APlayer.min.css"><script src="\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\js\Meting.min.js"></script><h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><ul><li>用maven配置，新建项目编译时提示以下错误信息<br><code>java: 程序包org.springframework.context不存在</code><br><code>java: 程序包org.springframework.context.support不存在</code></li></ul><h2 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h2><ul><li>idea的Maven有没有勾选，没有的话勾上，然后ok，运行一下项目，等加载完成就ok了。不勾选的，项目是用IDEA实现的没有链到Maven，所以会出现包不存在。</li></ul><h2 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h2><ul><li>ctrl+shift+S 打开设置勾选<br><img src="/blog-img/javaError2.png" alt="Alt text"></li></ul>]]></content>
      
      
      <categories>
          
          <category> 问题集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 问题集 </tag>
            
            <tag> maven </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>单元测试执行多次，导致插入数据重复</title>
      <link href="/posts/javaError2/"/>
      <url>/posts/javaError2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\css\APlayer.min.css"><script src="\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\js\Meting.min.js"></script><p><strong>问题：在用单元测试代码时，重复执行，导致向数据库插入两次数据。</strong></p><p><strong>原因：单元测试时会先build进行编译，而build的时候会执行你项目中的所有加了@Test的方法。</strong></p><p><img src="/blog-img/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E9%87%8D%E5%A4%8D.jpg" alt="Alt text"></p><p><strong>解决：通过在pom.xml配置文件进行配置。</strong></p><blockquote><p><code>&lt;build&gt;</code><br>&emsp; <code>&lt;plugins&gt;</code><br>&emsp;&emsp;<code>&lt;plugin&gt;</code><br>&emsp;&emsp;&emsp;<code>&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;</code><br>&emsp;&emsp;&emsp; <code>&lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;</code><br>&emsp;&emsp;&emsp;<code>&lt;configuration&gt;</code><br>&emsp;&emsp;&emsp;&emsp;  <code>&lt;skipTests&gt;true&lt;/skipTests&gt;</code><br>&emsp;&emsp;&emsp;  <code>&lt;/configuration&gt;</code><br>&emsp;&emsp; <code>&lt;/plugin&gt;</code><br>&emsp; <code>&lt;/plugins&gt;</code><br><code>&lt;/build&gt;</code></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 问题集 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 问题集 </tag>
            
            <tag> junit </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Markdown基础语法</title>
      <link href="/posts/Markdown/"/>
      <url>/posts/Markdown/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\css\APlayer.min.css"><script src="\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\js\Meting.min.js"></script><h1 id="认识Markdown"><a href="#认识Markdown" class="headerlink" title="认识Markdown"></a>认识Markdown</h1><blockquote><p>Markdown是一种可以使用普通文本编辑器编写的标记语言，通过简单的标记语法，它可以使普通文本内容具有一定的格式。<br>Markdown具有一系列衍生版本，用于扩展Markdown的功能（如表格、脚注、内嵌HTML等等），这些功能原初的Markdown尚不具备，它们能让Markdown转换成更多的格式，例如LaTeX，Docbook。</p></blockquote><p>简单来说，一般我们用的字处理软件Word或Pages有大量的排版、字体设置，而Markdown是个非常容易学习的排版语法。</p><p>Markdown 的优点如下：</p><ul><li>纯文本，所以兼容性极强，可以用所有文本编辑器打开。</li><li>让你专注于文字而不是排版。</li><li>格式转换方便，Markdown 的文本你可以轻松转换为 html、电子书等。</li><li>Markdown 的标记语法有极好的可读性。</li></ul><h1 id="Markdown编辑工具"><a href="#Markdown编辑工具" class="headerlink" title="Markdown编辑工具"></a>Markdown编辑工具</h1><p>推荐新手使用<a href="https://maxiang.io/" target="_blank" rel="noopener">马克飞象 </a> 编辑器，对新手极其友好。</p><p><img src="/blog-img/Markdown/1590415731146.png" alt="Alt text"></p><p>热爱编程和码字博客主也可以选择<a href="https://www.cnblogs.com/xueweihan/archive/2019/10/24/11728087.html" target="_blank" rel="noopener">这五款免费的Markdown编辑器</a></p><h1 id="Markdown语法"><a href="#Markdown语法" class="headerlink" title="Markdown语法"></a>Markdown语法</h1><h2 id="1-标题"><a href="#1-标题" class="headerlink" title="1. 标题"></a>1. 标题</h2><p>标题能显示出文章的结构。行首插入1-6个 # ，每增加一个 # 表示更深入层次的内容，对应到标题的深度由 1-6 阶。<strong>注意：需要在 # 后加一个空格，这是最标准的Markdown语法。</strong></p><p><img src="/blog-img/Markdown/1590417132717.png" alt="Alt text"></p><h2 id="2-文本样式"><a href="#2-文本样式" class="headerlink" title="2.文本样式"></a>2.文本样式</h2><p>（带“*”星号的文本样式，在原版Markdown标准中不存在，但在其大部分衍生标准中被添加）</p><p><img src="/blog-img/Markdown/1590417166411.png" alt="Alt text"></p><p>补充：markdowm首行缩进方法–一个空格<code>&amp;ensp;</code> 两个空格 <code>&amp;emsp;</code></p><h2 id="3-图片"><a href="#3-图片" class="headerlink" title="3.图片"></a>3.图片</h2><p>插入图片的语法就是在插入链接的语法前面加’!’。</p><p>插入网络上已存在的图片可以使用图床，这里推荐<a href="https://imgchr.com" target="_blank" rel="noopener">路过图床</a> ，生成URL地址即可。<strong>（以下使用马克飞象快捷键）</strong></p><p><img src="/blog-img/Markdown/1590418153960.png" alt="Alt text"></p><h2 id="4-注释"><a href="#4-注释" class="headerlink" title="4.注释"></a>4.注释</h2><ul><li><p><strong>html注释</strong></p><p>Markdown内嵌html语法，所以可以用html注释。</p><blockquote><p><code>&lt;!--哈哈我是注释，不会在浏览器中显示。--&gt;</code></p></blockquote></li><li><p><strong>hack方法</strong><br>hack方法就是利用markdown的解析原理来实现注释的。</p><blockquote><p><code>[comment]: &lt;&gt; (注释，不会在浏览器中显示。)</code><br><code>[comment]: &lt;&gt; (哈哈我是注释，不会在浏览器中显示。)</code><br><code>[comment]: &lt;&gt; (哈哈我是注释，不会在浏览器中显示。)</code><br><code>[//]: &lt;&gt; (哈哈我是注释，不会在浏览器中显示。)</code><br><code>[//]: # (哈哈我是注释，不会在浏览器中显示。)</code><br>可以用表情包形式注释，例如<br><code>[*_*]: 注释内容</code><br><code>[^_^]: 其中[]中的内容可以自定义</code><br><code>[@_@]: 但是这个注释在代码段中无效，只能在外部使用</code></p></blockquote></li></ul><h2 id="5-脚注"><a href="#5-脚注" class="headerlink" title="5.脚注"></a>5.脚注</h2><p> 脚注一般位于页面的底部，可以作为文档某处内容的注释.</p><blockquote><p>这里是脚注[^脚注]<br>[^脚注]: 这里是脚注的内容，”脚注”可以替换成数字或字母.</p></blockquote><h2 id="6-表格"><a href="#6-表格" class="headerlink" title="6.表格"></a>6.表格</h2><p> 表格的语法麻烦一点</p><p><code>| 测试  |   测试     | 测试   |</code><br><code>| :------- | :-------:| ----: |</code><br><code>|</code>:<code>表示左对齐|</code>::<code>表示居中 |</code>:<code>表示右对齐|</code></p><p>效果：</p><table><thead><tr><th align="left">测试</th><th align="center">测试</th><th align="right">测试</th></tr></thead><tbody><tr><td align="left"><code>:</code>表示左对齐</td><td align="center"><code>::</code>表示居中</td><td align="right"><code>:</code> 表示右对齐</td></tr></tbody></table><h2 id="7-流程图"><a href="#7-流程图" class="headerlink" title="7.流程图"></a>7.流程图</h2><p><img src="/blog-img/Markdown/1590424467082.png" alt="Alt text"></p><p>以及时序图:</p><p><img src="/blog-img/Markdown/1590424554284.png" alt="Alt text"></p><h1 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h1><p>看到这里你应该熟悉了Markdown 的基本语法啦，然后可以去这个在线<a href="https://daringfireball.net/projects/markdown/dingus" target="_blank" rel="noopener">markdown-html在线转换上</a> 练习，不用一小时就可以掌握了。</p>]]></content>
      
      
      <categories>
          
          <category> 编辑 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 轻量级标记语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HelloWorld</title>
      <link href="/posts/Myblog/"/>
      <url>/posts/Myblog/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\css\APlayer.min.css"><script src="\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\js\Meting.min.js"></script><h1 id="我的第一个-博客！！！"><a href="#我的第一个-博客！！！" class="headerlink" title="我的第一个 博客！！！"></a>我的第一个 博客！！！</h1><p>使用hexo admin 快速部署博客<br><img src="/blog-img/pasted-0.png" alt="upload successful"></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">[language] [title] [url] [link text]</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
